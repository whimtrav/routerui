import{d as Jt,f as i,a as o,c as _t,s as v}from"../chunks/DhZLAEWt.js";import{o as Qt}from"../chunks/D-tgmMSQ.js";import{p as Vt,s as W,a as Xt,g as s,b as Yt,e as Zt,d as a,c as e,$ as $t,n as q,r as t,f as z,h as X,t as B}from"../chunks/N1otwjTT.js";import{i as h}from"../chunks/CWp393YG.js";import{e as G,i as J}from"../chunks/CxGl9W59.js";import{h as te,s as Y}from"../chunks/DtPs97YY.js";import{r as ee}from"../chunks/uT__Kkxm.js";import{a as se}from"../chunks/DLE3Upo7.js";var ae=i('<div class="text-gray-400">Loading security data...</div>'),re=i("<button> </button>"),ve=i('<p class="text-gray-500 text-center py-8">No recent security events</p>'),oe=i('<span class="text-xs px-1.5 py-0.5 bg-red-500/30 text-red-300 rounded">WAN</span>'),ie=i('<span class="text-xs px-1.5 py-0.5 bg-gray-500/30 text-gray-400 rounded">LAN</span>'),le=i('<span class="font-mono text-xs bg-gray-700 px-2 py-0.5 rounded"> </span>'),de=i('<div><div class="flex items-center justify-between mb-1"><div class="flex items-center gap-2"><span> </span> <span class="font-medium"> </span> <!></div> <span class="text-xs font-mono"> </span></div> <div class="flex items-center gap-4 text-sm"><!> <span class="text-gray-400 truncate"> </span></div></div>'),ne=i('<div class="space-y-2 max-h-96 overflow-y-auto"></div>'),ce=i('<div class="card svelte-4rm2pb"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold">Recent Security Events</h3> <button class="text-sm text-blue-400 hover:text-blue-300">Refresh</button></div> <!></div>'),pe=i('<p class="text-gray-500 text-center py-8">No active connections</p>'),_e=i('<tr class="border-b border-gray-700/50"><td class="py-2 font-mono text-xs"> </td><td class="py-2 font-mono text-xs"> </td><td class="py-2"><span class="text-xs px-2 py-0.5 bg-green-500/20 text-green-400 rounded"> </span></td><td class="py-2 text-gray-400 text-xs"> </td></tr>'),xe=i('<div class="overflow-x-auto"><table class="w-full text-sm"><thead><tr class="text-left text-gray-400 border-b border-gray-700"><th class="pb-2">Local Address</th><th class="pb-2">Remote Address</th><th class="pb-2">State</th><th class="pb-2">Process</th></tr></thead><tbody></tbody></table></div>'),ue=i('<div class="card svelte-4rm2pb"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold"> </h3> <button class="text-sm text-blue-400 hover:text-blue-300">Refresh</button></div> <!></div>'),be=i('<p class="text-gray-500 text-center py-8">No active SSH sessions</p>'),fe=i('<div class="p-4 bg-gray-700/50 rounded flex items-center justify-between"><div class="flex items-center gap-4"><div class="w-10 h-10 bg-blue-500/20 rounded-full flex items-center justify-center"><span class="text-blue-400">ðŸ‘¤</span></div> <div><p class="font-medium"> </p> <p class="text-sm text-gray-400"> </p></div></div> <div class="text-right"><span class="text-xs px-2 py-1 bg-green-500/20 text-green-400 rounded"> </span> <p class="text-xs text-gray-400 mt-1"> </p></div></div>'),me=i('<div class="space-y-3"></div>'),ge=i('<div class="card svelte-4rm2pb"><h3 class="text-lg font-semibold mb-4">Active SSH Sessions</h3> <!></div>'),ye=i('<tr class="border-b border-gray-700/50"><td class="py-2 font-mono"> </td><td class="py-2 text-red-400"> </td><td class="py-2 text-gray-400"> </td><td class="py-2"> </td></tr>'),he=i('<div class="card svelte-4rm2pb"><h3 class="text-lg font-semibold mb-4">Top Blocked IPs</h3> <div class="overflow-x-auto"><table class="w-full text-sm"><thead><tr class="text-left text-gray-400 border-b border-gray-700"><th class="pb-2">IP Address</th><th class="pb-2">Hits</th><th class="pb-2">Last Seen</th><th class="pb-2">Reason</th></tr></thead><tbody></tbody></table></div></div>'),we=i('<div class="grid grid-cols-2 md:grid-cols-4 gap-4"><div class="card text-center svelte-4rm2pb"><p class="text-3xl font-bold text-red-400"> </p> <p class="text-sm text-gray-400">Firewall Blocks</p></div> <div class="card text-center svelte-4rm2pb"><p class="text-3xl font-bold text-yellow-400"> </p> <p class="text-sm text-gray-400">Blocklist Hits</p></div> <div class="card text-center svelte-4rm2pb"><p class="text-3xl font-bold text-orange-400"> </p> <p class="text-sm text-gray-400">Failed SSH</p></div> <div class="card text-center svelte-4rm2pb"><p class="text-3xl font-bold text-green-400"> </p> <p class="text-sm text-gray-400">Active Connections</p></div></div> <div class="card svelte-4rm2pb"><h3 class="text-lg font-semibold mb-4">Blocklist Status</h3> <div class="grid grid-cols-2 gap-4"><div class="p-4 bg-gray-700/50 rounded flex items-center justify-between"><div><p class="font-medium">Spamhaus DROP</p> <p class="text-xs text-gray-400">Known spam/malware sources</p></div> <span> </span></div> <div class="p-4 bg-gray-700/50 rounded flex items-center justify-between"><div><p class="font-medium">Emerging Threats</p> <p class="text-xs text-gray-400">Malicious IP addresses</p></div> <span> </span></div></div></div> <div class="border-b border-gray-700"><nav class="flex gap-4"></nav></div> <!> <!>',1),Se=i('<div class="space-y-6"><div class="flex items-center justify-between"><div><h2 class="text-2xl font-bold">Security Monitor</h2> <p class="text-sm text-gray-500">Real-time security events and threat monitoring</p></div> <label class="flex items-center gap-2 text-sm"><input type="checkbox" class="rounded"/> <span class="text-gray-400">Auto-refresh (30s)</span></label></div> <!></div>');function Le(Rt,Ct){Vt(Ct,!0);let xt=W(!0),c=W(null),Q=W(Xt([])),O=W("overview"),Z=W(!0);async function $(){try{const r=await fetch("/api/security/overview");r.ok&&z(c,await r.json(),!0)}catch(r){console.error(r)}finally{z(xt,!1)}}async function V(){try{const r=await fetch("/api/security/connections");r.ok&&z(Q,await r.json(),!0)}catch(r){console.error(r)}}Qt(()=>{$(),V();const r=setInterval(()=>{s(Z)&&($(),s(O)==="connections"&&V())},3e4);return()=>clearInterval(r)});function Ht(r){switch(r){case"high":return"bg-red-500/20 text-red-400 border-red-500/50";case"medium":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/50";case"info":return"bg-blue-500/20 text-blue-400 border-blue-500/50";default:return"bg-gray-500/20 text-gray-400 border-gray-500/50"}}function It(r){switch(r){case"Failed Login":return"ðŸš«";case"Successful Login":return"âœ…";case"Sudo Command":return"âš¡";case"SSH Session Opened":return"ðŸ”“";case"SSH Session Closed":return"ðŸ”’";case"Session Opened":return"ðŸ”“";case"Session Closed":return"ðŸ”’";default:return"ðŸ“‹"}}function Nt(r){var E;return!r||r==="Unknown"?r:((E=r.split("T")[1])==null?void 0:E.split(".")[0])||r}var tt=Se();te("4rm2pb",r=>{Zt(()=>{$t.title="Security - RouterUI"})});var et=e(tt),ut=a(e(et),2),bt=e(ut);ee(bt),q(2),t(ut),t(et);var Lt=a(et,2);{var Pt=r=>{var E=ae();o(r,E)},Tt=r=>{var E=_t(),Bt=X(E);{var Et=st=>{var ft=we(),at=X(ft),rt=e(at),mt=e(rt),Ft=e(mt,!0);t(mt),q(2),t(rt);var vt=a(rt,2),gt=e(vt),Ot=e(gt,!0);t(gt),q(2),t(vt);var ot=a(vt,2),yt=e(ot),Mt=e(yt,!0);t(yt),q(2),t(ot);var ht=a(ot,2),wt=e(ht),Ut=e(wt,!0);t(wt),q(2),t(ht),t(at);var it=a(at,2),St=a(e(it),2),lt=e(St),dt=a(e(lt),2),Dt=e(dt,!0);t(dt),t(lt);var kt=a(lt,2),nt=a(e(kt),2),Kt=e(nt,!0);t(nt),t(kt),t(St),t(it);var ct=a(it,2),At=e(ct);G(At,20,()=>[{id:"overview",label:"Event Feed"},{id:"connections",label:"Active Connections"},{id:"sessions",label:"SSH Sessions"}],J,(g,_)=>{var b=re();b.__click=()=>{z(O,_.id,!0),_.id==="connections"&&V()};var N=e(b,!0);t(b),B(()=>{Y(b,1,`tab-btn ${s(O)===_.id?"tab-active":""}`,"svelte-4rm2pb"),v(N,_.label)}),o(g,b)}),t(At),t(ct);var jt=a(ct,2);{var Wt=g=>{var _=ce(),b=e(_),N=a(e(b),2);N.__click=$,t(b);var M=a(b,2);{var w=p=>{var x=ve();o(p,x)},f=p=>{var x=ne();G(x,21,()=>s(c).recent_events,J,(j,d)=>{var S=de(),y=e(S),R=e(y),l=e(R),u=e(l,!0);t(l);var L=a(l,2),C=e(L,!0);t(L);var F=a(L,2);{var k=n=>{var m=oe();o(n,m)},P=n=>{var m=ie();o(n,m)};h(F,n=>{s(d).is_external?n(k):n(P,!1)})}t(R);var A=a(R,2),D=e(A,!0);t(A),t(y);var H=a(y,2),U=e(H);{var T=n=>{var m=le(),pt=e(m,!0);t(m),B(()=>v(pt,s(d).source_ip)),o(n,m)};h(U,n=>{s(d).source_ip!=="N/A"&&n(T)})}var I=a(U,2),K=e(I,!0);t(I),t(H),t(S),B((n,m,pt)=>{Y(S,1,`p-3 rounded border ${n??""}`,"svelte-4rm2pb"),v(u,m),v(C,s(d).event_type),v(D,pt),v(K,s(d).details)},[()=>Ht(s(d).severity),()=>It(s(d).event_type),()=>Nt(s(d).timestamp)]),o(j,S)}),t(x),o(p,x)};h(M,p=>{s(c).recent_events.length===0?p(w):p(f,!1)})}t(_),o(g,_)},qt=g=>{var _=_t(),b=X(_);{var N=w=>{var f=ue(),p=e(f),x=e(p),j=e(x);t(x);var d=a(x,2);d.__click=V,t(p);var S=a(p,2);{var y=l=>{var u=pe();o(l,u)},R=l=>{var u=xe(),L=e(u),C=a(e(L));G(C,21,()=>s(Q),J,(F,k)=>{var P=_e(),A=e(P),D=e(A,!0);t(A);var H=a(A),U=e(H,!0);t(H);var T=a(H),I=e(T),K=e(I,!0);t(I),t(T);var n=a(T),m=e(n,!0);t(n),t(P),B(()=>{v(D,s(k).local_addr),v(U,s(k).remote_addr),v(K,s(k).state),v(m,s(k).process||"-")}),o(F,P)}),t(C),t(L),t(u),o(l,u)};h(S,l=>{s(Q).length===0?l(y):l(R,!1)})}t(f),B(()=>v(j,`Active Network Connections (${s(Q).length??""})`)),o(w,f)},M=w=>{var f=_t(),p=X(f);{var x=j=>{var d=ge(),S=a(e(d),2);{var y=l=>{var u=be();o(l,u)},R=l=>{var u=me();G(u,21,()=>s(c).ssh_sessions,J,(L,C)=>{var F=fe(),k=e(F),P=a(e(k),2),A=e(P),D=e(A,!0);t(A);var H=a(A,2),U=e(H);t(H),t(P),t(k);var T=a(k,2),I=e(T),K=e(I,!0);t(I);var n=a(I,2),m=e(n,!0);t(n),t(T),t(F),B(()=>{v(D,s(C).user),v(U,`from ${s(C).source_ip??""}`),v(K,s(C).status),v(m,s(C).timestamp)}),o(L,F)}),t(u),o(l,u)};h(S,l=>{s(c).ssh_sessions.length===0?l(y):l(R,!1)})}t(d),o(j,d)};h(p,j=>{s(O)==="sessions"&&j(x)},!0)}o(w,f)};h(b,w=>{s(O)==="connections"?w(N):w(M,!1)},!0)}o(g,_)};h(jt,g=>{s(O)==="overview"?g(Wt):g(qt,!1)})}var zt=a(jt,2);{var Gt=g=>{var _=he(),b=a(e(_),2),N=e(b),M=a(e(N));G(M,21,()=>s(c).top_blocked_ips,J,(w,f)=>{var p=ye(),x=e(p),j=e(x,!0);t(x);var d=a(x),S=e(d,!0);t(d);var y=a(d),R=e(y,!0);t(y);var l=a(y),u=e(l,!0);t(l),t(p),B(()=>{v(j,s(f).ip),v(S,s(f).hits),v(R,s(f).last_seen),v(u,s(f).reason)}),o(w,p)}),t(M),t(N),t(b),t(_),o(g,_)};h(zt,g=>{s(c).top_blocked_ips.length>0&&g(Gt)})}B(()=>{v(Ft,s(c).firewall_drops_24h),v(Ot,s(c).blocklist_hits.spamhaus_drop+s(c).blocklist_hits.emerging_threats),v(Mt,s(c).failed_ssh_attempts_24h),v(Ut,s(c).active_connections),Y(dt,1,`text-2xl font-bold ${s(c).blocklist_hits.spamhaus_drop>0?"text-red-400":"text-green-400"}`),v(Dt,s(c).blocklist_hits.spamhaus_drop),Y(nt,1,`text-2xl font-bold ${s(c).blocklist_hits.emerging_threats>0?"text-red-400":"text-green-400"}`),v(Kt,s(c).blocklist_hits.emerging_threats)}),o(st,ft)};h(Bt,st=>{s(c)&&st(Et)},!0)}o(r,E)};h(Lt,r=>{s(xt)?r(Pt):r(Tt,!1)})}t(tt),se(bt,()=>s(Z),r=>z(Z,r)),o(Rt,tt),Yt()}Jt(["click"]);export{Le as component};
