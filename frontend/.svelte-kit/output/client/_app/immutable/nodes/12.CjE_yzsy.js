import{d as Zt,f as c,a as n,s as g,e as $t,c as kt}from"../chunks/DhZLAEWt.js";import{o as te}from"../chunks/D-tgmMSQ.js";import{p as ee,s as _,a as Ot,b as ae,e as se,d as a,c as s,f as r,g as t,$ as oe,r as e,h as ct,t as k,n as re}from"../chunks/N1otwjTT.js";import{i as h}from"../chunks/CWp393YG.js";import{e as Rt,i as Ut}from"../chunks/CxGl9W59.js";import{h as ie,s as wt}from"../chunks/DtPs97YY.js";import{r as le}from"../chunks/uT__Kkxm.js";import{b as ne}from"../chunks/DLE3Upo7.js";import{b as jt}from"../chunks/7SKTmCmy.js";var ve=c('<div class="text-gray-400">Loading...</div>'),ce=c("<option> </option>"),pe=c('<p class="text-gray-400">Loading logs...</p>'),de=c('<pre class="whitespace-pre-wrap text-gray-300"> </pre>'),ue=c('<p class="text-gray-500">No logs to display</p>'),_e=c('<div class="card svelte-hj1sc2"><h3 class="text-lg font-semibold mb-4">System Logs</h3> <div class="flex flex-wrap gap-3 mb-4"><select class="input svelte-hj1sc2"></select> <select class="input svelte-hj1sc2"><option>All Priorities</option><option>Emergency</option><option>Alert</option><option>Critical</option><option>Error</option><option>Warning</option><option>Notice</option><option>Info</option><option>Debug</option></select> <select class="input svelte-hj1sc2"><option>50 lines</option><option>100 lines</option><option>250 lines</option><option>500 lines</option><option>1000 lines</option></select> <input type="text" placeholder="Filter text..." class="input flex-1 min-w-48 svelte-hj1sc2"/> <button class="btn-primary svelte-hj1sc2"> </button></div> <div class="bg-gray-900 rounded p-4 font-mono text-xs overflow-auto max-h-[600px]"><!></div></div>'),fe=c('<pre class="whitespace-pre-wrap text-green-400"> </pre>'),ge=c('<p class="text-gray-500">Click "Check Updates" to see available updates</p>'),me=c('<span class="animate-pulse text-green-400">█</span>'),be=c('<div class="space-y-4"><div class="card svelte-hj1sc2"><div class="flex items-center justify-between mb-4"><div><h3 class="text-lg font-semibold">System Updates</h3> <p class="text-sm text-gray-400">Check and install system package updates</p></div> <div class="flex gap-2"><button class="btn-secondary svelte-hj1sc2"> </button> <button class="btn-primary svelte-hj1sc2"> </button></div></div> <div class="terminal svelte-hj1sc2"><!> <!></div></div></div>'),he=c('<div class="flex items-center justify-between p-3 bg-gray-700/50 rounded"><div><p class="font-medium font-mono text-sm"> </p> <p class="text-xs text-gray-400"> </p></div> <div class="flex gap-2"><button class="btn-secondary text-sm svelte-hj1sc2">View / Restore</button> <button class="btn-danger text-sm svelte-hj1sc2">Delete</button></div></div>'),xe=c('<div class="space-y-2"></div>'),ye=c('<div class="text-center py-8 text-gray-500"><p>No backups found.</p> <p class="text-sm">Create a backup to get started.</p></div>'),ke=c('<div><p class="text-sm font-medium text-gray-400 mb-1">DHCP/DNS Config</p> <pre class="text-xs bg-gray-900 p-2 rounded overflow-x-auto max-h-32"> </pre></div>'),we=c('<div><p class="text-sm font-medium text-gray-400 mb-1">WiFi Config</p> <pre class="text-xs bg-gray-900 p-2 rounded overflow-x-auto max-h-32"> </pre></div>'),je=c('<div><p class="text-sm font-medium text-gray-400 mb-1">Static Leases</p> <pre class="text-xs bg-gray-900 p-2 rounded overflow-x-auto max-h-32"> </pre></div>'),Ce=c('<div><p class="text-sm font-medium text-gray-400 mb-1">Firewall Rules</p> <pre class="text-xs bg-gray-900 p-2 rounded overflow-x-auto max-h-32"> </pre></div>'),Se=c('<div class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4"><div class="bg-gray-800 rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col"><div class="flex items-center justify-between p-4 border-b border-gray-700"><div><h3 class="text-lg font-semibold">Backup Details</h3> <p class="text-sm text-gray-400"> </p></div> <button class="text-gray-400 hover:text-white text-2xl">&times;</button></div> <div class="flex-1 overflow-auto p-4 space-y-3"><!> <!> <!> <!></div> <div class="p-4 border-t border-gray-700 flex justify-end gap-2"><button class="btn-secondary svelte-hj1sc2">Close</button> <button class="btn-warning svelte-hj1sc2"> </button></div></div></div>'),Be=c('<div class="space-y-4"><div class="card svelte-hj1sc2"><div class="flex items-center justify-between"><div><h3 class="text-lg font-semibold">Create Backup</h3> <p class="text-sm text-gray-400">Backup current router configurations</p></div> <button class="btn-primary svelte-hj1sc2"> </button></div> <p class="text-xs text-gray-500 mt-3">Backups include: DHCP config, WiFi config, static leases, firewall rules, WoL devices, and protection whitelist.</p></div> <div class="card svelte-hj1sc2"><h3 class="text-lg font-semibold mb-4">Available Backups</h3> <!></div> <!></div>'),Te=c('<div class="border-b border-gray-700"><nav class="flex gap-4"><button>System Logs</button> <button>Updates</button> <button>Backup & Restore</button></nav></div> <!>',1),Pe=c('<div class="space-y-6"><div><h2 class="text-2xl font-bold">System</h2> <p class="text-sm text-gray-500">System logs, updates, and backup management.</p></div> <!></div>');function Ae(Dt,Ft){ee(Ft,!0);let Ct=_(!0),U=_("logs"),St=_(Ot([])),pt=_(""),dt=_(""),ut=_(100),_t=_(""),ft=_(""),it=_(!1),gt=_(Ot([])),lt=_(!1),nt=_(!1),d=_(null),w=_(""),st=_(!1),Y=_(!1);async function mt(){try{const[o,i]=await Promise.all([fetch("/api/tools/logs/units"),fetch("/api/tools/backup/list")]);o.ok&&r(St,await o.json(),!0),i.ok&&r(gt,await i.json(),!0)}catch(o){console.error(o)}finally{r(Ct,!1)}}te(()=>{mt(),Z()});async function Z(){r(it,!0);try{const o=await fetch("/api/tools/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({unit:t(pt)||null,priority:t(dt)||null,lines:t(ut),grep:t(_t)||null})});if(o.ok){const i=await o.json();r(ft,i.logs,!0)}}finally{r(it,!1)}}async function Nt(){r(st,!0),r(w,`Checking for updates...
`);try{const o=await fetch("/api/system/updates/check",{method:"POST"});if(o.ok){const i=await o.json();r(w,i.output,!0)}else r(w,"Failed to check for updates")}catch(o){r(w,"Error: "+o.message)}finally{r(st,!1)}}async function Mt(){if(confirm("This will install system updates. The system may need to restart some services. Continue?")){r(Y,!0),r(w,`Starting system update...

`);try{const o=await fetch("/api/system/updates/install",{method:"POST"});if(o.ok){const i=await o.json();r(w,i.output,!0)}else r(w,t(w)+`
Failed to run updates`)}catch(o){r(w,t(w)+(`
Error: `+o.message))}finally{r(Y,!1)}}}async function Et(){r(lt,!0);try{(await fetch("/api/tools/backup/create",{method:"POST"})).ok&&await mt()}finally{r(lt,!1)}}async function At(o){const i=await fetch("/api/tools/backup/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:o})});i.ok&&r(d,await i.json(),!0)}async function It(){var o;if((o=t(d))!=null&&o.configs&&confirm("This will restore the selected backup and overwrite current configurations. Continue?")){r(nt,!0);try{const i=await fetch("/api/tools/backup/restore",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t(d).configs)});if(i.ok){const I=await i.json();I.success?alert("Backup restored successfully! Some services may need to be restarted."):alert("Restore completed with errors: "+I.errors.join(", ")),r(d,null)}}finally{r(nt,!1)}}}async function Jt(o){if(!confirm("Delete this backup?"))return;(await fetch("/api/tools/backup/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:o})})).ok&&await mt()}function Wt(o){if(!o||o===0)return"0 B";const i=1024,I=["B","KB","MB"],ot=Math.floor(Math.log(o)/Math.log(i));return parseFloat((o/Math.pow(i,ot)).toFixed(1))+" "+I[ot]}function Bt(o){try{return new Date(o).toLocaleString()}catch{return o}}var bt=Pe();ie("hj1sc2",o=>{se(()=>{oe.title="System - RouterUI"})});var zt=a(s(bt),2);{var qt=o=>{var i=ve();n(o,i)},Ht=o=>{var i=Te(),I=ct(i),ot=s(I),ht=s(ot);ht.__click=()=>r(U,"logs");var xt=a(ht,2);xt.__click=()=>r(U,"updates");var Tt=a(xt,2);Tt.__click=()=>r(U,"backup"),e(ot),e(I);var Gt=a(I,2);{var Kt=$=>{var tt=_e(),rt=a(s(tt),2),H=s(rt);H.__change=Z,Rt(H,21,()=>t(St),Ut,(l,y)=>{var b=ce(),q=s(b,!0);e(b);var E={};k(()=>{g(q,t(y).description||t(y).name||"All Logs"),E!==(E=t(y).name)&&(b.value=(b.__value=t(y).name)??"")}),n(l,b)}),e(H);var G=a(H,2);G.__change=Z;var T=s(G);T.value=T.__value="";var P=a(T);P.value=P.__value="0";var J=a(P);J.value=J.__value="1";var D=a(J);D.value=D.__value="2";var L=a(D);L.value=L.__value="3";var x=a(L);x.value=x.__value="4";var F=a(x);F.value=F.__value="5";var C=a(F);C.value=C.__value="6";var N=a(C);N.value=N.__value="7",e(G);var O=a(G,2);O.__change=Z;var R=s(O);R.value=R.__value=50;var K=a(R);K.value=K.__value=100;var V=a(K);V.value=V.__value=250;var Q=a(V);Q.value=Q.__value=500;var et=a(Q);et.value=et.__value=1e3,e(O);var u=a(O,2);le(u);var v=a(u,2);v.__click=Z;var m=s(v,!0);e(v),e(rt);var W=a(rt,2),S=s(W);{var M=l=>{var y=pe();n(l,y)},z=l=>{var y=kt(),b=ct(y);{var q=j=>{var A=de(),at=s(A,!0);e(A),k(()=>g(at,t(ft))),n(j,A)},E=j=>{var A=ue();n(j,A)};h(b,j=>{t(ft)?j(q):j(E,!1)},!0)}n(l,y)};h(S,l=>{t(it)?l(M):l(z,!1)})}e(W),e(tt),k(()=>g(m,t(it)?"Loading...":"Refresh")),jt(H,()=>t(pt),l=>r(pt,l)),jt(G,()=>t(dt),l=>r(dt,l)),jt(O,()=>t(ut),l=>r(ut,l)),$t("keypress",u,l=>l.key==="Enter"&&Z()),ne(u,()=>t(_t),l=>r(_t,l)),n($,tt)},Vt=$=>{var tt=kt(),rt=ct(tt);{var H=T=>{var P=be(),J=s(P),D=s(J),L=a(s(D),2),x=s(L);x.__click=Nt;var F=s(x,!0);e(x);var C=a(x,2);C.__click=Mt;var N=s(C,!0);e(C),e(L),e(D);var O=a(D,2),R=s(O);{var K=u=>{var v=fe(),m=s(v,!0);e(v),k(()=>g(m,t(w))),n(u,v)},V=u=>{var v=ge();n(u,v)};h(R,u=>{t(w)?u(K):u(V,!1)})}var Q=a(R,2);{var et=u=>{var v=me();n(u,v)};h(Q,u=>{t(Y)&&u(et)})}e(O),e(J),e(P),k(()=>{x.disabled=t(st)||t(Y),g(F,t(st)?"Checking...":"Check Updates"),C.disabled=t(st)||t(Y),g(N,t(Y)?"Updating...":"Install Updates")}),n(T,P)},G=T=>{var P=kt(),J=ct(P);{var D=L=>{var x=Be(),F=s(x),C=s(F),N=a(s(C),2);N.__click=Et;var O=s(N,!0);e(N),e(C),re(2),e(F);var R=a(F,2),K=a(s(R),2);{var V=v=>{var m=xe();Rt(m,21,()=>t(gt),Ut,(W,S)=>{var M=he(),z=s(M),l=s(z),y=s(l,!0);e(l);var b=a(l,2),q=s(b);e(b),e(z);var E=a(z,2),j=s(E);j.__click=()=>At(t(S).filename);var A=a(j,2);A.__click=()=>Jt(t(S).filename),e(E),e(M),k((at,yt)=>{g(y,t(S).filename),g(q,`${at??""} • ${yt??""}`)},[()=>Bt(t(S).created),()=>Wt(t(S).size)]),n(W,M)}),e(m),n(v,m)},Q=v=>{var m=ye();n(v,m)};h(K,v=>{t(gt).length>0?v(V):v(Q,!1)})}e(R);var et=a(R,2);{var u=v=>{var m=Se();m.__click=()=>r(d,null);var W=s(m);W.__click=p=>p.stopPropagation();var S=s(W),M=s(S),z=a(s(M),2),l=s(z);e(z),e(M);var y=a(M,2);y.__click=()=>r(d,null),e(S);var b=a(S,2),q=s(b);{var E=p=>{var f=ke(),B=a(s(f),2),X=s(B,!0);e(B),e(f),k(()=>g(X,t(d).configs.dnsmasq)),n(p,f)};h(q,p=>{t(d).configs.dnsmasq&&p(E)})}var j=a(q,2);{var A=p=>{var f=we(),B=a(s(f),2),X=s(B,!0);e(B),e(f),k(()=>g(X,t(d).configs.hostapd)),n(p,f)};h(j,p=>{t(d).configs.hostapd&&p(A)})}var at=a(j,2);{var yt=p=>{var f=je(),B=a(s(f),2),X=s(B,!0);e(B),e(f),k(()=>g(X,t(d).configs.static_leases)),n(p,f)};h(at,p=>{t(d).configs.static_leases&&p(yt)})}var Qt=a(at,2);{var Xt=p=>{var f=Ce(),B=a(s(f),2),X=s(B,!0);e(B),e(f),k(()=>g(X,t(d).configs.iptables)),n(p,f)};h(Qt,p=>{t(d).configs.iptables&&p(Xt)})}e(b);var Pt=a(b,2),Lt=s(Pt);Lt.__click=()=>r(d,null);var vt=a(Lt,2);vt.__click=It;var Yt=s(vt,!0);e(vt),e(Pt),e(W),e(m),k(p=>{g(l,`${p??""} • ${t(d).hostname??""}`),vt.disabled=t(nt),g(Yt,t(nt)?"Restoring...":"Restore This Backup")},[()=>Bt(t(d).created)]),n(v,m)};h(et,v=>{t(d)&&v(u)})}e(x),k(()=>{N.disabled=t(lt),g(O,t(lt)?"Creating...":"Create Backup")}),n(L,x)};h(J,L=>{t(U)==="backup"&&L(D)},!0)}n(T,P)};h(rt,T=>{t(U)==="updates"?T(H):T(G,!1)},!0)}n($,tt)};h(Gt,$=>{t(U)==="logs"?$(Kt):$(Vt,!1)})}k(()=>{wt(ht,1,`tab-btn ${t(U)==="logs"?"tab-active":""}`,"svelte-hj1sc2"),wt(xt,1,`tab-btn ${t(U)==="updates"?"tab-active":""}`,"svelte-hj1sc2"),wt(Tt,1,`tab-btn ${t(U)==="backup"?"tab-active":""}`,"svelte-hj1sc2")}),n(o,i)};h(zt,o=>{t(Ct)?o(qt):o(Ht,!1)})}e(bt),n(Dt,bt),ae()}Zt(["click","change"]);export{Ae as component};
