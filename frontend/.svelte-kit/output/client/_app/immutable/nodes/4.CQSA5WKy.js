import{d as na,f as n,a as i,c as et,s as v}from"../chunks/DhZLAEWt.js";import{o as va}from"../chunks/D-tgmMSQ.js";import{p as da,s as P,a as Rt,b as oa,e as la,$ as ca,d as s,c as a,g as e,r as t,f as m,h as z,n as J,t as K}from"../chunks/N1otwjTT.js";import{i as w}from"../chunks/CWp393YG.js";import{e as St,i as kt}from"../chunks/CxGl9W59.js";import{h as ua,s as $}from"../chunks/DtPs97YY.js";import{r as Bt,s as _a}from"../chunks/uT__Kkxm.js";import{b as pa}from"../chunks/DLE3Upo7.js";var ma=n('<div class="text-gray-400">Loading...</div>'),xa=n('<div class="card bg-red-900/20 border-red-700"><p class="text-red-400">ClamAV is not installed. Please install it to use antivirus features.</p></div>'),fa=n('<div class="text-center py-8"><div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-400 mb-4 svelte-1wdtwm"></div> <p class="text-blue-400">Scanning in progress...</p> <p class="text-sm text-gray-500">This may take a while depending on the number of files.</p></div>'),ba=n('<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"><button class="scan-card svelte-1wdtwm"><div class="text-3xl mb-2">üè†</div> <div class="font-medium">Scan Home</div> <div class="text-sm text-gray-400">/home directory</div></button> <button class="scan-card svelte-1wdtwm"><div class="text-3xl mb-2">üìÅ</div> <div class="font-medium">Scan Temp</div> <div class="text-sm text-gray-400">/tmp directory</div></button> <button class="scan-card svelte-1wdtwm"><div class="text-3xl mb-2">üåê</div> <div class="font-medium">Scan Web</div> <div class="text-sm text-gray-400">/var/www directory</div></button></div> <div class="border-t border-gray-700 pt-4"><h4 class="font-medium mb-2">Custom Scan</h4> <div class="flex gap-2"><input type="text" placeholder="Enter path to scan (e.g., /home/user/downloads)" class="input flex-1 svelte-1wdtwm"/> <button class="btn-primary svelte-1wdtwm">Scan</button></div></div>',1),ga=n('<div class="card"><h3 class="text-lg font-semibold mb-4">Scan for Threats</h3> <!></div>'),ya=n('<div class="text-center py-8 text-gray-500"><p>No scans performed yet.</p> <p class="text-sm">Run a scan to see results here.</p></div>'),ha=n('<span class="text-xs px-2 py-0.5 bg-red-500/20 text-red-400 rounded"> </span>'),wa=n('<span class="text-xs px-2 py-0.5 bg-green-500/20 text-green-400 rounded">Clean</span>'),Sa=n('<div class="text-sm text-gray-300 flex justify-between"><span class="font-mono truncate flex-1"> </span> <span class="text-red-400 ml-2"> </span></div>'),ka=n('<div class="mt-2 pt-2 border-t border-gray-600"><div class="text-sm font-medium text-red-400 mb-1">Threats Found:</div> <!></div>'),ja=n('<div class="p-4 bg-gray-700/50 rounded"><div class="flex items-center justify-between mb-2"><div class="flex items-center gap-2"><span class="font-medium"> </span> <!></div> <span class="text-sm text-gray-400"> </span></div> <div class="text-sm text-gray-400"> </div> <!></div>'),qa=n('<div class="space-y-3"></div>'),Ta=n('<div class="card"><h3 class="text-lg font-semibold mb-4">Scan History</h3> <!></div>'),Ca=n('<div class="text-center py-8 text-gray-500"><p>No files in quarantine.</p></div>'),Aa=n('<div class="flex items-center justify-between p-3 bg-gray-700/50 rounded"><div class="flex-1"><div class="font-mono text-sm"> </div> <div class="text-xs text-gray-400"> </div></div> <div class="flex gap-2"><button class="text-xs px-3 py-1 bg-yellow-500/20 text-yellow-400 rounded hover:bg-yellow-500/30">Restore</button> <button class="text-xs px-3 py-1 bg-red-500/20 text-red-400 rounded hover:bg-red-500/30">Delete</button></div></div>'),Na=n('<div class="space-y-2"></div>'),Va=n('<div class="card"><h3 class="text-lg font-semibold mb-4">Quarantined Files</h3> <p class="text-sm text-gray-400 mb-4">Files detected as threats are moved here. You can delete them permanently or restore if it was a false positive.</p> <!></div>'),Da=n(`<div class="card"><h3 class="text-lg font-semibold mb-4">Settings</h3> <div class="space-y-4"><div class="flex items-center justify-between p-3 bg-gray-700/50 rounded"><div><div class="font-medium">ClamAV Daemon</div> <div class="text-sm text-gray-400">Keep daemon running for faster scans</div></div> <label class="toggle svelte-1wdtwm"><input type="checkbox" class="svelte-1wdtwm"/> <span class="toggle-slider svelte-1wdtwm"></span></label></div> <div class="p-3 bg-gray-700/50 rounded"><div class="font-medium mb-2">Version Information</div> <div class="text-sm text-gray-400 space-y-1"><div> </div> <div> </div> <div> </div> <div> </div></div></div> <div class="p-3 bg-blue-900/20 border border-blue-700/50 rounded"><div class="text-sm text-blue-400"><strong>Note:</strong> Virus signatures are automatically updated by the freshclam service.
              You can manually update using the button above if needed.</div></div></div></div>`),Oa=n('<div class="card"><div class="grid grid-cols-2 md:grid-cols-4 gap-4"><div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-green-400"> </p> <p class="text-xs text-gray-400">Virus Signatures</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-blue-400"> </p> <p class="text-xs text-gray-400">Database Version</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p> </p> <p class="text-xs text-gray-400">Daemon Status</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-orange-400"> </p> <p class="text-xs text-gray-400">Quarantined</p></div></div> <div class="mt-4 flex items-center justify-between text-sm text-gray-400"><span> </span> <button class="btn-secondary text-sm svelte-1wdtwm"> </button></div></div> <div class="border-b border-gray-700"><nav class="flex gap-4"><button>Scan Now</button> <button>Scan History</button> <button> </button> <button>Settings</button></nav></div> <!>',1),Pa=n('<div class="space-y-6"><div class="flex items-center justify-between"><div><h2 class="text-2xl font-bold">Antivirus</h2> <p class="text-sm text-gray-500">ClamAV virus scanner and protection.</p></div></div> <!></div>');function La(Ft,Qt){da(Qt,!0);let jt=P(!0),c=P(null),Y=P(Rt([])),st=P(Rt([])),rt=P(!1),X=P(!1),x=P("status"),it=P("/home");async function B(){try{const[r,u,k]=await Promise.all([fetch("/api/antivirus/status"),fetch("/api/antivirus/history"),fetch("/api/antivirus/quarantine")]);r.ok&&m(c,await r.json(),!0),u.ok&&m(Y,await u.json(),!0),k.ok&&m(st,await k.json(),!0)}catch(r){console.error(r)}finally{m(jt,!1)}}va(()=>{B();const r=setInterval(B,3e4);return()=>clearInterval(r)});async function Ut(){m(X,!0);try{(await fetch("/api/antivirus/update",{method:"POST"})).ok&&await B()}finally{m(X,!1)}}async function Z(r){m(rt,!0);try{const u=await fetch("/api/antivirus/scan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:r,quarantine:!0})});if(u.ok){const k=await u.json();m(Y,[k,...e(Y)],!0),m(x,"history")}}finally{m(rt,!1),await B()}}async function qt(r,u){(await fetch("/api/antivirus/quarantine/action",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:r,action:u})})).ok&&await B()}async function Ht(){(await fetch("/api/antivirus/daemon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({enabled:!e(c).daemon_running})})).ok&&await B()}function It(r){if(r===0)return"0 B";const u=1024,k=["B","KB","MB","GB"],tt=Math.floor(Math.log(r)/Math.log(u));return parseFloat((r/Math.pow(u,tt)).toFixed(2))+" "+k[tt]}function nt(r){return(r==null?void 0:r.toLocaleString())||"0"}var vt=Pa();ua("1wdtwm",r=>{la(()=>{ca.title="Antivirus - RouterUI"})});var Lt=s(a(vt),2);{var zt=r=>{var u=ma();i(r,u)},Jt=r=>{var u=et(),k=z(u);{var tt=F=>{var M=xa();i(F,M)},Kt=F=>{var M=Oa(),dt=z(M),ot=a(dt),lt=a(ot),Tt=a(lt),Yt=a(Tt,!0);t(Tt),J(2),t(lt);var ct=s(lt,2),Ct=a(ct),Et=a(Ct,!0);t(Ct),J(2),t(ct);var ut=s(ct,2),_t=a(ut),Gt=a(_t,!0);t(_t),J(2),t(ut);var At=s(ut,2),Nt=a(At),Wt=a(Nt,!0);t(Nt),J(2),t(At),t(ot);var Vt=s(ot,2),pt=a(Vt),$t=a(pt);t(pt);var at=s(pt,2);at.__click=Ut;var Xt=a(at,!0);t(at),t(Vt),t(dt);var mt=s(dt,2),Dt=a(mt),xt=a(Dt);xt.__click=()=>m(x,"scan");var ft=s(xt,2);ft.__click=()=>m(x,"history");var E=s(ft,2);E.__click=()=>m(x,"quarantine");var Zt=a(E);t(E);var Ot=s(E,2);Ot.__click=()=>m(x,"settings"),t(Dt),t(mt);var ta=s(mt,2);{var aa=C=>{var Q=ga(),bt=s(a(Q),2);{var gt=f=>{var g=fa();i(f,g)},yt=f=>{var g=ba(),R=z(g),U=a(R);U.__click=()=>Z("/home");var H=s(U,2);H.__click=()=>Z("/tmp");var _=s(H,2);_.__click=()=>Z("/var/www"),t(R);var p=s(R,2),A=s(a(p),2),o=a(A);Bt(o);var y=s(o,2);y.__click=()=>Z(e(it)),t(A),t(p),pa(o,()=>e(it),l=>m(it,l)),i(f,g)};w(bt,f=>{e(rt)?f(gt):f(yt,!1)})}t(Q),i(C,Q)},ea=C=>{var Q=et(),bt=z(Q);{var gt=f=>{var g=Ta(),R=s(a(g),2);{var U=_=>{var p=ya();i(_,p)},H=_=>{var p=qa();St(p,21,()=>e(Y),kt,(A,o)=>{var y=ja(),l=a(y),b=a(l),j=a(b),S=a(j,!0);t(j);var q=s(j,2);{var N=d=>{var h=ha(),W=a(h);t(h),K(()=>v(W,`${e(o).threats_found??""} threats`)),i(d,h)},V=d=>{var h=wa();i(d,h)};w(q,d=>{e(o).threats_found>0?d(N):d(V,!1)})}t(b);var D=s(b,2),I=a(D,!0);t(D),t(l);var T=s(l,2),L=a(T);t(T);var O=s(T,2);{var G=d=>{var h=ka(),W=s(a(h),2);St(W,17,()=>e(o).threats,kt,(sa,Pt)=>{var ht=Sa(),wt=a(ht),ra=a(wt,!0);t(wt);var Mt=s(wt,2),ia=a(Mt,!0);t(Mt),t(ht),K(()=>{v(ra,e(Pt).file_path),v(ia,e(Pt).threat_name)}),i(sa,ht)}),t(h),i(d,h)};w(O,d=>{e(o).threats.length>0&&d(G)})}t(y),K(d=>{v(S,e(o).path),v(I,e(o).completed_at||e(o).started_at),v(L,`Scanned ${d??""} files`)},[()=>nt(e(o).files_scanned)]),i(A,y)}),t(p),i(_,p)};w(R,_=>{e(Y).length===0?_(U):_(H,!1)})}t(g),i(f,g)},yt=f=>{var g=et(),R=z(g);{var U=_=>{var p=Va(),A=s(a(p),4);{var o=l=>{var b=Ca();i(l,b)},y=l=>{var b=Na();St(b,21,()=>e(st),kt,(j,S)=>{var q=Aa(),N=a(q),V=a(N),D=a(V,!0);t(V);var I=s(V,2),T=a(I);t(I),t(N);var L=s(N,2),O=a(L);O.__click=()=>qt(e(S).id,"restore");var G=s(O,2);G.__click=()=>qt(e(S).id,"delete"),t(L),t(q),K(d=>{v(D,e(S).id),v(T,`${d??""} - Quarantined ${e(S).quarantined_at??""}`)},[()=>It(e(S).size_bytes)]),i(j,q)}),t(b),i(l,b)};w(A,l=>{e(st).length===0?l(o):l(y,!1)})}t(p),i(_,p)},H=_=>{var p=et(),A=z(p);{var o=y=>{var l=Da(),b=s(a(l),2),j=a(b),S=s(a(j),2),q=a(S);Bt(q),q.__change=Ht,J(2),t(S),t(j);var N=s(j,2),V=s(a(N),2),D=a(V),I=a(D);t(D);var T=s(D,2),L=a(T);t(T);var O=s(T,2),G=a(O);t(O);var d=s(O,2),h=a(d);t(d),t(V),t(N),J(2),t(b),t(l),K(W=>{_a(q,e(c).daemon_running),v(I,`ClamAV: ${e(c).version??""}`),v(L,`Signature Database: ${e(c).signature_version??""}`),v(G,`Signatures: ${W??""}`),v(h,`Last Update: ${e(c).last_update??""}`)},[()=>nt(e(c).signature_count)]),i(y,l)};w(A,y=>{e(x)==="settings"&&y(o)},!0)}i(_,p)};w(R,_=>{e(x)==="quarantine"?_(U):_(H,!1)},!0)}i(f,g)};w(bt,f=>{e(x)==="history"?f(gt):f(yt,!1)},!0)}i(C,Q)};w(ta,C=>{e(x)==="scan"?C(aa):C(ea,!1)})}K(C=>{v(Yt,C),v(Et,e(c).signature_version),$(_t,1,`text-2xl font-bold ${e(c).daemon_running?"text-green-400":"text-yellow-400"}`),v(Gt,e(c).daemon_running?"Active":"Stopped"),v(Wt,e(c).quarantine_count),v($t,`Last Updated: ${e(c).last_update??""}`),at.disabled=e(X),v(Xt,e(X)?"Updating...":"Update Signatures"),$(xt,1,`tab-btn ${e(x)==="scan"?"tab-active":""}`,"svelte-1wdtwm"),$(ft,1,`tab-btn ${e(x)==="history"?"tab-active":""}`,"svelte-1wdtwm"),$(E,1,`tab-btn ${e(x)==="quarantine"?"tab-active":""}`,"svelte-1wdtwm"),v(Zt,`Quarantine (${e(c).quarantine_count??""})`),$(Ot,1,`tab-btn ${e(x)==="settings"?"tab-active":""}`,"svelte-1wdtwm")},[()=>nt(e(c).signature_count)]),i(F,M)};w(k,F=>{var M;(M=e(c))!=null&&M.installed?F(Kt,!1):F(tt)},!0)}i(r,u)};w(Lt,r=>{e(jt)?r(zt):r(Jt,!1)})}t(vt),i(Ft,vt),oa()}na(["click","change"]);export{La as component};
