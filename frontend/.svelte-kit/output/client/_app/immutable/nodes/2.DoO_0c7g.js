import{c as Pt,a as x,f as $,s as l}from"../chunks/DhZLAEWt.js";import{o as se}from"../chunks/D-tgmMSQ.js";import{h as zt,c as a,r as e,d as s,n as pt,t as C,g as t,aq as A,p as re,s as Z,a as ie,b as le,e as de,$ as ve,f as tt}from"../chunks/N1otwjTT.js";import{i as et}from"../chunks/CWp393YG.js";import{e as wt,i as kt}from"../chunks/CxGl9W59.js";import{h as ne,s as Mt,c as $t}from"../chunks/DtPs97YY.js";import{a as r}from"../chunks/uT__Kkxm.js";import{s as Ht}from"../chunks/DFr9IBvo.js";import{p as ot}from"../chunks/xc3IYCKh.js";var oe=$('<div class="gauge-wrapper svelte-2b1hd3"><div class="gauge-label svelte-2b1hd3"> </div> <svg><defs><linearGradient x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#22c55e"></stop><stop offset="60%" stop-color="#eab308"></stop><stop offset="100%" stop-color="#ef4444"></stop></linearGradient></defs><path fill="none" stroke="#374151" stroke-linecap="round"></path><path fill="none" stroke-linecap="round"></path><g><line x1="0" y1="0" y2="0" stroke="#f9fafb" stroke-width="2" stroke-linecap="round"></line><circle cx="0" cy="0" r="4" fill="#f9fafb"></circle></g><text fill="#6b7280" font-size="10" font-family="system-ui">0</text><text fill="#6b7280" font-size="10" font-family="system-ui">100.0</text></svg> <div class="speed-value svelte-2b1hd3"><span class="value svelte-2b1hd3"> </span> <span class="unit svelte-2b1hd3"> </span></div></div>'),ce=$('<div class="gauge-wrapper svelte-2b1hd3"><div class="gauge-label svelte-2b1hd3"> </div> <svg><circle fill="none" stroke="#374151"></circle><circle fill="none" stroke-linecap="round"></circle><text text-anchor="middle" dominant-baseline="middle" fill="#f9fafb" font-weight="bold" font-family="system-ui, -apple-system, sans-serif"> </text><text text-anchor="middle" fill="#6b7280" font-family="system-ui, -apple-system, sans-serif"> </text></svg></div>');function ct(Bt,W){let n=ot(W,"value",3,0),S=ot(W,"max",3,100),O=ot(W,"label",3,""),xt=ot(W,"unit",3,"%"),i=ot(W,"size",3,120),E=ot(W,"type",3,"ring"),G=A(()=>typeof n()=="number"?n():parseFloat(n())||0),at=A(()=>Math.min(100,Math.max(0,t(G)/S()*100))),h=A(()=>i()/2-8),X=A(()=>i()/2),I=A(()=>i()/2);const st=6;function Dt(c){return c<50?"#22c55e":c<75?"#eab308":c<90?"#f97316":"#ef4444"}let mt=A(()=>Dt(t(at))),d=A(()=>2*Math.PI*t(h)),_=A(()=>t(d)-t(at)/100*t(d)),q=A(()=>-180+t(at)*1.8);var F=Pt(),rt=zt(F);{var u=c=>{var z=oe(),B=a(z),it=a(B,!0);e(B);var p=s(B,2),y=a(p),m=a(y);e(y);var w=s(y);r(w,"stroke-width",st+2);var P=s(w);r(P,"stroke-width",st);var k=s(P),lt=a(k);pt(),e(k);var H=s(k),ut=s(H);e(p);var gt=s(p,2),K=a(gt),At=a(K,!0);e(K);var dt=s(K,2),bt=a(dt,!0);e(dt),e(gt),e(z),C(vt=>{l(it,O()),r(p,"width",i()*1.2),r(p,"height",i()*.8),r(p,"viewBox",`0 0 ${i()*1.2} ${i()*.8}`),r(m,"id",`speed-gradient-${O()??""}`),r(w,"d",`M ${i()*.15} ${i()*.65} A ${t(h)??""} ${t(h)??""} 0 0 1 ${i()*1.05} ${i()*.65}`),r(P,"d",`M ${i()*.15} ${i()*.65} A ${t(h)??""} ${t(h)??""} 0 0 1 ${i()*1.05} ${i()*.65}`),r(P,"stroke",`url(#speed-gradient-${O()??""})`),r(k,"transform",`translate(${i()*.6}, ${i()*.65}) rotate(${t(q)??""})`),r(lt,"x2",t(h)-10),r(H,"x",i()*.1),r(H,"y",i()*.78),r(ut,"x",i()*1),r(ut,"y",i()*.78),Ht(K,`color: ${t(mt)??""}`),l(At,vt),l(bt,xt())},[()=>t(G).toFixed(1)]),x(c,z)},f=c=>{var z=ce(),B=a(z),it=a(B,!0);e(B);var p=s(B,2),y=a(p);r(y,"stroke-width",st);var m=s(y);r(m,"stroke-width",st);var w=s(m),P=a(w,!0);e(w);var k=s(w),lt=a(k,!0);e(k),e(p),e(z),C(H=>{l(it,O()),r(p,"width",i()),r(p,"height",i()),r(p,"viewBox",`0 0 ${i()??""} ${i()??""}`),r(y,"cx",t(X)),r(y,"cy",t(I)),r(y,"r",t(h)),r(y,"transform",`rotate(-90 ${t(X)??""} ${t(I)??""})`),r(m,"cx",t(X)),r(m,"cy",t(I)),r(m,"r",t(h)),r(m,"stroke",t(mt)),r(m,"stroke-dasharray",t(d)),r(m,"stroke-dashoffset",t(_)),r(m,"transform",`rotate(-90 ${t(X)??""} ${t(I)??""})`),r(w,"x",t(X)),r(w,"y",t(I)-2),r(w,"font-size",i()/5),l(P,H),r(k,"x",t(X)),r(k,"y",t(I)+i()/6),r(k,"font-size",i()/10),l(lt,xt())},[()=>t(G).toFixed(t(G)>=100?0:t(G)>=10?1:2)]),x(c,z)};et(rt,c=>{E()==="speedometer"?c(u):c(f,!1)})}x(Bt,F)}var pe=$('<div class="text-gray-400">Loading...</div>'),xe=$('<div class="card bg-red-900/20 border-red-700 text-red-400"> </div>'),ue=$('<div class="flex-1 bg-gray-600 rounded-t relative"><div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-blue-500 to-green-500 rounded-t"></div></div>'),_e=$('<div class="mt-2 pt-2 border-t border-gray-600"><p class="text-gray-400 text-xs mb-1">Last 24h</p> <div class="flex h-8 gap-px"></div></div>'),fe=$('<div class="bg-gray-700/50 rounded p-4"><div class="flex items-center justify-between mb-2"><span class="font-medium"> </span> <span class="text-xs text-gray-500"> </span></div> <div class="grid grid-cols-2 gap-2 text-sm"><div><p class="text-gray-400 text-xs">Download</p> <p class="text-green-400 font-medium"> </p></div> <div><p class="text-gray-400 text-xs">Upload</p> <p class="text-blue-400 font-medium"> </p></div></div> <!></div>'),me=$('<div class="card"><h3 class="text-lg font-semibold mb-3">Bandwidth Usage</h3> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"></div> <p class="text-xs text-gray-500 mt-3">Traffic data collected by vnstat. Statistics accumulate over time.</p></div>'),ge=$('<div class="card"><div class="flex items-center justify-between mb-3"><h3 class="text-lg font-semibold">AdGuard Home</h3> <span> </span></div> <div class="grid grid-cols-2 md:grid-cols-4 gap-4"><div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold"> </p> <p class="text-xs text-gray-400">DNS Queries</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-red-400"> </p> <p class="text-xs text-gray-400">Blocked</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold"> </p> <p class="text-xs text-gray-400">Block Rate</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold"> </p> <p class="text-xs text-gray-400">Avg Response</p></div></div></div>'),be=$('<tr class="border-b border-gray-700/50"><td class="py-2 font-medium"> </td><td> </td><td> </td><td class="text-gray-400"> </td><td> </td><td> </td></tr>'),he=$('<div class="flex items-center gap-2 p-2 bg-gray-700/50 rounded"><span>*</span> <span class="text-sm"> </span></div>'),ye=$('<div class="card"><div class="flex flex-wrap items-center justify-center gap-6"><!> <!> <!> <!> <!> <!></div></div> <!> <!> <div class="card"><h3 class="text-lg font-semibold mb-3">WAN Status</h3> <div class="flex flex-wrap items-center gap-4"><span> </span> <span class="text-gray-400">|</span> <span>Interface: <span class="text-blue-400"> </span></span> <span class="text-gray-400">|</span> <span>IP: <span class="text-blue-400"> </span></span> <span class="text-gray-400">|</span> <span>Gateway: <span class="text-blue-400"> </span></span></div></div> <div class="card"><h3 class="text-lg font-semibold mb-3">Network Interfaces</h3> <div class="overflow-x-auto"><table class="w-full text-sm"><thead><tr class="text-left text-gray-400 border-b border-gray-700"><th class="pb-2">Interface</th><th class="pb-2">State</th><th class="pb-2">IPv4</th><th class="pb-2">MAC</th><th class="pb-2">RX Total</th><th class="pb-2">TX Total</th></tr></thead><tbody></tbody></table></div></div> <div class="card"><h3 class="text-lg font-semibold mb-3">Services</h3> <div class="grid grid-cols-2 md:grid-cols-4 gap-3"></div></div>',1),we=$('<div class="space-y-6"><div class="flex items-center justify-between"><div><h2 class="text-2xl font-bold">System Overview</h2> <p class="text-sm text-gray-500">Overview of the key system metrics.</p></div></div> <!></div>');function Fe(Bt,W){re(W,!0);let n=Z(null),S=Z(null),O=Z(null),xt=Z(!0),i=Z(null),E=Z(null),G=Z(ie({rxMbps:0,txMbps:0}));async function at(){var d;try{const[_,q,F]=await Promise.all([fetch("/api/dashboard"),fetch("/api/adguard/overview"),fetch("/api/tools/traffic")]);if(!_.ok)throw new Error("Failed to fetch dashboard");const rt=await _.json(),u=(d=rt.interfaces)==null?void 0:d.find(f=>f.name==="enp1s0");if(u&&t(E)){const f=(Date.now()-t(E).timestamp)/1e3;if(f>0){const c=u.rx_bytes-t(E).rx_bytes,z=u.tx_bytes-t(E).tx_bytes;tt(G,{rxMbps:Math.max(0,c*8/(f*1e6)),txMbps:Math.max(0,z*8/(f*1e6))},!0)}}u&&tt(E,{rx_bytes:u.rx_bytes,tx_bytes:u.tx_bytes,timestamp:Date.now()},!0),tt(n,rt,!0),q.ok&&tt(S,await q.json(),!0),F.ok&&tt(O,await F.json(),!0)}catch(_){tt(i,_.message,!0)}finally{tt(xt,!1)}}se(()=>{at();const d=setInterval(at,3e3);return()=>clearInterval(d)});function h(d){if(!d||d===0)return"0 B";const _=1024,q=["B","KB","MB","GB","TB"],F=Math.floor(Math.log(d)/Math.log(_));return parseFloat((d/Math.pow(_,F)).toFixed(2))+" "+q[F]}function X(d){switch(d){case"enp1s0":return"WAN";case"enp2s0":return"LAN";case"wlo1":return"WiFi";case"tailscale0":return"Tailscale";default:return d}}var I=we();ne("1uha8ag",d=>{de(()=>{ve.title="Dashboard - RouterUI"})});var st=s(a(I),2);{var Dt=d=>{var _=pe();x(d,_)},mt=d=>{var _=Pt(),q=zt(_);{var F=u=>{var f=xe(),c=a(f,!0);e(f),C(()=>l(c,t(i))),x(u,f)},rt=u=>{var f=Pt(),c=zt(f);{var z=B=>{var it=ye(),p=zt(it),y=a(p),m=a(y);ct(m,{get value(){return t(n).system.memory.percent_used},max:100,label:"Memory",unit:"%",size:100,type:"ring"});var w=s(m,2);ct(w,{get value(){return t(n).system.storage.percent_used},max:100,label:"Storage",unit:"%",size:100,type:"ring"});var P=s(w,2);ct(P,{get value(){return t(n).system.cpu_usage},max:100,label:"CPU",unit:"%",size:160,type:"speedometer"});var k=s(P,2);ct(k,{get value(){return t(G).rxMbps},max:100,label:"Download",unit:"Mbps",size:100,type:"ring"});var lt=s(k,2);ct(lt,{get value(){return t(G).txMbps},max:100,label:"Upload",unit:"Mbps",size:100,type:"ring"});var H=s(lt,2);ct(H,{get value(){return t(n).system.memory.used_mb},get max(){return t(n).system.memory.total_mb},label:"Used RAM",unit:"MB",size:100,type:"ring"}),e(y),e(p);var ut=s(p,2);{var gt=D=>{var v=me(),o=s(a(v),2);wt(o,21,()=>t(O).interfaces.filter(g=>["enp1s0","enp2s0","wlo1","tailscale0"].includes(g.name)),kt,(g,b)=>{var M=fe(),L=a(M),R=a(L),_t=a(R,!0);e(R);var U=s(R,2),nt=a(U,!0);e(U),e(L);var N=s(L,2),T=a(N),V=s(a(T),2),ft=a(V,!0);e(V),e(T);var Q=s(T,2),Y=s(a(Q),2),Rt=a(Y,!0);e(Y),e(Q),e(N);var Ut=s(N,2);{var jt=J=>{var j=_e(),ht=s(a(j),2);wt(ht,21,()=>t(b).hourly.slice(-24),kt,(Zt,Gt)=>{const te=A(()=>Math.max(...t(b).hourly.slice(-24).map(Et=>Et.rx+Et.tx),1)),ee=A(()=>(t(Gt).rx+t(Gt).tx)/t(te)*100);var yt=ue(),ae=a(yt);e(yt),C(()=>{r(yt,"title",t(Gt).timestamp),Ht(ae,`height: ${t(ee)??""}%`)}),x(Zt,yt)}),e(ht),e(j),x(J,j)};et(Ut,J=>{var j;((j=t(b).daily)==null?void 0:j.length)>0&&J(jt)})}e(M),C((J,j,ht)=>{l(_t,J),l(nt,t(b).name),l(ft,j),l(Rt,ht)},[()=>X(t(b).name),()=>h(t(b).total_rx),()=>h(t(b).total_tx)]),x(g,M)}),e(o),pt(2),e(v),x(D,v)};et(ut,D=>{var v,o;((o=(v=t(O))==null?void 0:v.interfaces)==null?void 0:o.length)>0&&D(gt)})}var K=s(ut,2);{var At=D=>{var v=ge(),o=a(v),g=s(a(o),2),b=a(g,!0);e(g),e(o);var M=s(o,2),L=a(M),R=a(L),_t=a(R,!0);e(R),pt(2),e(L);var U=s(L,2),nt=a(U),N=a(nt,!0);e(nt),pt(2),e(U);var T=s(U,2),V=a(T),ft=a(V);e(V),pt(2),e(T);var Q=s(T,2),Y=a(Q),Rt=a(Y);e(Y),pt(2),e(Q),e(M),e(v),C((Ut,jt,J,j)=>{Mt(g,1,$t(t(S).protection_enabled?"status-active":"status-inactive")),l(b,t(S).protection_enabled?"Protected":"Unprotected"),l(_t,Ut),l(N,jt),l(ft,`${J??""}%`),l(Rt,`${j??""}ms`)},[()=>t(S).dns_queries.toLocaleString(),()=>t(S).blocked_filtering.toLocaleString(),()=>t(S).blocked_percentage.toFixed(1),()=>t(S).avg_processing_time.toFixed(1)]),x(D,v)};et(K,D=>{t(S)&&D(At)})}var dt=s(K,2),bt=s(a(dt),2),vt=a(bt),Kt=a(vt,!0);e(vt);var St=s(vt,4),Lt=s(a(St)),Qt=a(Lt,!0);e(Lt),e(St);var It=s(St,4),Nt=s(a(It)),Yt=a(Nt,!0);e(Nt),e(It);var Tt=s(It,4),Ct=s(a(Tt)),Jt=a(Ct,!0);e(Ct),e(Tt),e(bt),e(dt);var Ft=s(dt,2),Wt=s(a(Ft),2),Ot=a(Wt),Xt=s(a(Ot));wt(Xt,21,()=>t(n).interfaces,kt,(D,v)=>{var o=be(),g=a(o),b=a(g,!0);e(g);var M=s(g),L=a(M,!0);e(M);var R=s(M),_t=a(R,!0);e(R);var U=s(R),nt=a(U,!0);e(U);var N=s(U),T=a(N,!0);e(N);var V=s(N),ft=a(V,!0);e(V),e(o),C((Q,Y)=>{l(b,t(v).name),Mt(M,1,$t(t(v).state==="UP"||t(v).state==="Active"?"status-active":"status-inactive")),l(L,t(v).state),l(_t,t(v).ipv4||"-"),l(nt,t(v).mac_address),l(T,Q),l(ft,Y)},[()=>h(t(v).rx_bytes),()=>h(t(v).tx_bytes)]),x(D,o)}),e(Xt),e(Ot),e(Wt),e(Ft);var qt=s(Ft,2),Vt=s(a(qt),2);wt(Vt,21,()=>t(n).services,kt,(D,v)=>{var o=he(),g=a(o),b=s(g,2),M=a(b,!0);e(b),e(o),C(()=>{Mt(g,1,$t(t(v).status==="active"?"status-active":"status-inactive")),l(M,t(v).display_name)}),x(D,o)}),e(Vt),e(qt),C(()=>{Mt(vt,1,$t(t(n).wan_status.connected?"status-active":"status-inactive")),l(Kt,t(n).wan_status.connected?"Connected":"Disconnected"),l(Qt,t(n).wan_status.interface),l(Yt,t(n).wan_status.ip_address),l(Jt,t(n).wan_status.gateway)}),x(B,it)};et(c,B=>{t(n)&&B(z)},!0)}x(u,f)};et(q,u=>{t(i)?u(F):u(rt,!1)},!0)}x(d,_)};et(st,d=>{t(xt)?d(Dt):d(mt,!1)})}e(I),x(Bt,I),le()}export{Fe as component};
