import{d as ie,f as c,a as r,s as n,c as jt}from"../chunks/DhZLAEWt.js";import{o as le}from"../chunks/D-tgmMSQ.js";import{p as ce,s as N,a as lt,b as ne,e as de,d as o,c as a,$ as ve,g as t,r as e,f as l,h as ct,n as Q,t as D}from"../chunks/N1otwjTT.js";import{i as j}from"../chunks/CWp393YG.js";import{e as nt,i as dt}from"../chunks/CxGl9W59.js";import{h as pe,s as at,c as be}from"../chunks/DtPs97YY.js";import{r as vt,s as Rt}from"../chunks/uT__Kkxm.js";import{b as Dt}from"../chunks/DLE3Upo7.js";var fe=c('<div class="text-gray-400">Loading...</div>'),_e=c('<span class="text-xs px-2 py-0.5 bg-green-500/20 text-green-400 rounded"> </span>'),ue=c('<p class="text-xs text-gray-500"> </p>'),ge=c('<div class="flex items-center justify-between p-3 bg-gray-700/50 rounded"><div class="flex-1"><div class="flex items-center gap-2"><span class="font-medium"> </span> <!></div> <p class="text-sm text-gray-400"> </p> <!></div> <label class="toggle svelte-14cy5cw"><input type="checkbox" class="svelte-14cy5cw"/> <span class="toggle-slider svelte-14cy5cw"></span></label></div>'),xe=c('<div class="card"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold">Threat Blocklists</h3> <button class="btn-secondary text-sm svelte-14cy5cw"> </button></div> <p class="text-sm text-gray-400 mb-4">Enable blocklists to automatically block known malicious IP addresses. These are updated from trusted security sources.</p> <div class="space-y-3"></div></div>'),he=c('<div class="flex items-center justify-between p-3 bg-gray-700/50 rounded"><div class="flex items-center gap-2"><span class="text-xl"> </span> <span> </span></div> <label class="toggle svelte-14cy5cw"><input type="checkbox" class="svelte-14cy5cw"/> <span class="toggle-slider svelte-14cy5cw"></span></label></div>'),ye=c('<div class="card"><h3 class="text-lg font-semibold mb-4">Country Blocking</h3> <div class="bg-yellow-900/20 border border-yellow-700/50 rounded p-3 mb-4"><p class="text-sm text-yellow-400"><strong>Note:</strong> If you use a VPN (like NordVPN to Netherlands), make sure to add the VPN server IPs to your Allowed IPs list before blocking that country.</p></div> <p class="text-sm text-gray-400 mb-4">Block all traffic from specific countries. Useful for blocking regions known for high attack volumes.</p> <div class="grid grid-cols-2 md:grid-cols-3 gap-3"></div></div>'),me=c('<button class="btn-secondary text-sm svelte-14cy5cw">Enable Logging</button>'),we=c('<span class="text-xs px-2 py-1 bg-green-500/20 text-green-400 rounded">Logging Active</span>'),ke=c('<div class="text-center py-8 text-gray-500"><p>No blocked traffic logged yet.</p> <p class="text-sm">Enable logging above to start tracking blocked connections.</p></div>'),Pe=c('<tr class="border-b border-gray-700/50 hover:bg-gray-700/30"><td class="py-2 text-gray-400"> </td><td class="py-2"><span> </span></td><td class="py-2 font-mono text-sm"> </td><td class="py-2 font-mono text-sm"> </td><td class="py-2"><span class="text-xs px-2 py-0.5 bg-red-500/20 text-red-400 rounded"> </span></td><td class="py-2"><button class="text-xs px-2 py-1 bg-green-500/20 text-green-400 rounded hover:bg-green-500/30">Allow</button></td></tr>'),Te=c('<div class="overflow-x-auto"><table class="w-full text-sm"><thead><tr class="text-left text-gray-400 border-b border-gray-700"><th class="pb-2">Time</th><th class="pb-2">Direction</th><th class="pb-2">Source IP</th><th class="pb-2">Dest</th><th class="pb-2">Reason</th><th class="pb-2">Action</th></tr></thead><tbody></tbody></table></div>'),je=c('<div class="card"><div class="flex items-center justify-between mb-4"><h3 class="text-lg font-semibold">Blocked Traffic Log</h3> <!></div> <p class="text-sm text-gray-400 mb-4">See traffic that was blocked in the last 24 hours. Click "Allow" to add an IP to your whitelist if it was blocked by mistake.</p> <!></div>'),Ie=c('<div class="text-center py-8 text-gray-500"><p>No IPs whitelisted yet.</p></div>'),Ae=c('<span class="text-gray-400 ml-2"> </span>'),Se=c('<div class="flex items-center justify-between p-3 bg-gray-700/50 rounded"><div><span class="font-mono"> </span> <!> <span class="text-xs text-gray-500 ml-2"> </span></div> <button class="text-red-400 hover:text-red-300 text-sm">Remove</button></div>'),Ne=c('<div class="space-y-2"></div>'),Oe=c('<div class="card"><h3 class="text-lg font-semibold mb-4">Allowed IPs (Whitelist)</h3> <p class="text-sm text-gray-400 mb-4">IPs on this list will never be blocked, even if they appear in a blocklist or blocked country.</p> <div class="flex gap-2 mb-4"><input type="text" placeholder="IP address (e.g., 1.2.3.4)" class="input flex-1 svelte-14cy5cw"/> <input type="text" placeholder="Description (optional)" class="input flex-1 svelte-14cy5cw"/> <button class="btn-primary svelte-14cy5cw">Add</button></div> <!></div>'),Be=c('<div class="card"><div class="grid grid-cols-2 md:grid-cols-4 gap-4"><div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-green-400"> </p> <p class="text-xs text-gray-400">Active Blocklists</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-blue-400"> </p> <p class="text-xs text-gray-400">Blocked IPs</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-red-400"> </p> <p class="text-xs text-gray-400">Blocked (24h)</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-purple-400"> </p> <p class="text-xs text-gray-400">Whitelisted</p></div></div></div> <div class="border-b border-gray-700"><nav class="flex gap-4"><button>Threat Lists</button> <button>Countries</button> <button>Blocked Traffic</button> <button>Allowed IPs</button></nav></div> <!>',1),Ce=c(`<div class="space-y-6"><div class="flex items-center justify-between"><div><h2 class="text-2xl font-bold">Protection</h2> <p class="text-sm text-gray-500">Block known threats and see what's being stopped.</p></div></div> <!></div>`);function $e(Ut,Mt){ce(Mt,!0);let It=N(!0),g=N("blocklists"),st=N(null),pt=N(lt({sources:[],total_ips:0})),ot=N(lt({entries:[],total_blocked_24h:0})),bt=N(lt([])),At=N(lt([])),I=N(!1);async function O(){try{const[s,d,x,E,w]=await Promise.all([fetch("/api/protection/status"),fetch("/api/protection/blocklists"),fetch("/api/protection/blocked-log"),fetch("/api/protection/whitelist"),fetch("/api/protection/countries")]);s.ok&&l(st,await s.json(),!0),d.ok&&l(pt,await d.json(),!0),x.ok&&l(ot,await x.json(),!0),E.ok&&l(bt,await E.json(),!0),w.ok&&l(At,await w.json(),!0)}catch(s){console.error(s)}finally{l(It,!1)}}le(()=>{O();const s=setInterval(O,1e4);return()=>clearInterval(s)});async function Wt(s,d){l(I,!0);try{(await fetch("/api/protection/blocklists/toggle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:s,enabled:d})})).ok&&await O()}finally{l(I,!1)}}async function Jt(){l(I,!0);try{await fetch("/api/protection/blocklists/update",{method:"POST"}),await O()}finally{l(I,!1)}}async function Et(s,d){l(I,!0);try{(await fetch("/api/protection/countries/toggle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:s,blocked:d})})).ok&&await O()}finally{l(I,!1)}}async function $t(s,d){(await fetch("/api/protection/whitelist/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:s,description:d})})).ok&&await O()}let X=N(""),rt=N("");async function Vt(){if(!t(X))return;(await fetch("/api/protection/whitelist/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:t(X),description:t(rt)||void 0})})).ok&&(l(X,""),l(rt,""),await O())}async function Ft(s){(await fetch("/api/protection/whitelist/remove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ip:s})})).ok&&await O()}async function qt(){await fetch("/api/protection/enable-logging",{method:"POST"}),await O()}function ft(s){return(s==null?void 0:s.toLocaleString())||"0"}function Ht(s){if(!s)return"";const d=s.toUpperCase().split("").map(x=>127397+x.charCodeAt(0));return String.fromCodePoint(...d)}function zt(s){if(!s)return"";const d=new Date(s),E=new Date-d,w=Math.floor(E/6e4);if(w<1)return"just now";if(w<60)return`${w}m ago`;const H=Math.floor(w/60);return H<24?`${H}h ago`:`${Math.floor(H/24)}d ago`}var _t=Ce();pe("14cy5cw",s=>{de(()=>{ve.title="Protection - RouterUI"})});var Gt=o(a(_t),2);{var Kt=s=>{var d=fe();r(s,d)},Qt=s=>{var d=Be(),x=ct(d),E=a(x),w=a(E),H=a(w),Xt=a(H,!0);e(H),Q(2),e(w);var ut=o(w,2),St=a(ut),Yt=a(St,!0);e(St),Q(2),e(ut);var gt=o(ut,2),Nt=a(gt),Zt=a(Nt,!0);e(Nt),Q(2),e(gt);var Ot=o(gt,2),Bt=a(Ot),te=a(Bt,!0);e(Bt),Q(2),e(Ot),e(E),e(x);var xt=o(x,2),Ct=a(xt),ht=a(Ct);ht.__click=()=>l(g,"blocklists");var yt=o(ht,2);yt.__click=()=>l(g,"countries");var mt=o(yt,2);mt.__click=()=>l(g,"log");var Lt=o(mt,2);Lt.__click=()=>l(g,"whitelist"),e(Ct),e(xt);var ee=o(xt,2);{var ae=U=>{var M=xe(),W=a(M),B=o(a(W),2);B.__click=Jt;var wt=a(B,!0);e(B),e(W);var C=o(W,4);nt(C,21,()=>t(pt).sources,dt,(J,f)=>{var $=ge(),k=a($),_=a(k),u=a(_),P=a(u,!0);e(u);var V=o(u,2);{var A=y=>{var m=_e(),b=a(m);e(m),D(p=>n(b,`${p??""} IPs`),[()=>ft(t(f).ip_count)]),r(y,m)};j(V,y=>{t(f).enabled&&y(A)})}e(_);var T=o(_,2),S=a(T,!0);e(T);var h=o(T,2);{var L=y=>{var m=ue(),b=a(m);e(m),D(()=>n(b,`Updated: ${t(f).last_updated??""}`)),r(y,m)};j(h,y=>{t(f).last_updated&&y(L)})}e(k);var v=o(k,2),i=a(v);vt(i),i.__change=()=>Wt(t(f).id,!t(f).enabled),Q(2),e(v),e($),D(()=>{n(P,t(f).name),n(S,t(f).description),Rt(i,t(f).enabled),i.disabled=t(I)}),r(J,$)}),e(C),e(M),D(()=>{B.disabled=t(I),n(wt,t(I)?"Updating...":"Update All")}),r(U,M)},se=U=>{var M=jt(),W=ct(M);{var B=C=>{var J=ye(),f=o(a(J),6);nt(f,21,()=>t(At),dt,($,k)=>{var _=he(),u=a(_),P=a(u),V=a(P,!0);e(P);var A=o(P,2),T=a(A,!0);e(A),e(u);var S=o(u,2),h=a(S);vt(h),h.__change=()=>Et(t(k).code,!t(k).blocked),Q(2),e(S),e(_),D(L=>{n(V,L),n(T,t(k).name),Rt(h,t(k).blocked),h.disabled=t(I)},[()=>Ht(t(k).code)]),r($,_)}),e(f),e(J),r(C,J)},wt=C=>{var J=jt(),f=ct(J);{var $=_=>{var u=je(),P=a(u),V=o(a(P),2);{var A=v=>{var i=me();i.__click=qt,r(v,i)},T=v=>{var i=we();r(v,i)};j(V,v=>{var i;(i=t(st))!=null&&i.log_enabled?v(T,!1):v(A)})}e(P);var S=o(P,4);{var h=v=>{var i=ke();r(v,i)},L=v=>{var i=Te(),y=a(i),m=o(a(y));nt(m,21,()=>t(ot).entries,dt,(b,p)=>{var Y=Pe(),R=a(Y),Z=a(R,!0);e(R);var F=o(R),q=a(F),kt=a(q,!0);e(q),e(F);var z=o(F),Pt=a(z,!0);e(z);var G=o(z),Tt=a(G);e(G);var tt=o(G),K=a(tt),et=a(K,!0);e(K),e(tt);var it=o(tt),oe=a(it);oe.__click=()=>$t(t(p).src_ip,`Allowed from blocked log - ${t(p).reason}`),e(it),e(Y),D(re=>{n(Z,re),at(q,1,be(t(p).direction==="inbound"?"text-red-400":"text-yellow-400")),n(kt,t(p).direction==="inbound"?"IN":"OUT"),n(Pt,t(p).src_ip),n(Tt,`${t(p).dst_ip??""}:${t(p).dst_port??""}`),n(et,t(p).reason||"firewall")},[()=>zt(t(p).timestamp)]),r(b,Y)}),e(m),e(y),e(i),r(v,i)};j(S,v=>{t(ot).entries.length===0?v(h):v(L,!1)})}e(u),r(_,u)},k=_=>{var u=jt(),P=ct(u);{var V=A=>{var T=Oe(),S=o(a(T),4),h=a(S);vt(h);var L=o(h,2);vt(L);var v=o(L,2);v.__click=Vt,e(S);var i=o(S,2);{var y=b=>{var p=Ie();r(b,p)},m=b=>{var p=Ne();nt(p,21,()=>t(bt),dt,(Y,R)=>{var Z=Se(),F=a(Z),q=a(F),kt=a(q,!0);e(q);var z=o(q,2);{var Pt=K=>{var et=Ae(),it=a(et);e(et),D(()=>n(it,`- ${t(R).description??""}`)),r(K,et)};j(z,K=>{t(R).description&&K(Pt)})}var G=o(z,2),Tt=a(G);e(G),e(F);var tt=o(F,2);tt.__click=()=>Ft(t(R).ip),e(Z),D(()=>{n(kt,t(R).ip),n(Tt,`Added ${t(R).added_at??""}`)}),r(Y,Z)}),e(p),r(b,p)};j(i,b=>{t(bt).length===0?b(y):b(m,!1)})}e(T),Dt(h,()=>t(X),b=>l(X,b)),Dt(L,()=>t(rt),b=>l(rt,b)),r(A,T)};j(P,A=>{t(g)==="whitelist"&&A(V)},!0)}r(_,u)};j(f,_=>{t(g)==="log"?_($):_(k,!1)},!0)}r(C,J)};j(W,C=>{t(g)==="countries"?C(B):C(wt,!1)},!0)}r(U,M)};j(ee,U=>{t(g)==="blocklists"?U(ae):U(se,!1)})}D((U,M)=>{var W,B;n(Xt,((W=t(st))==null?void 0:W.blocklists_active)||0),n(Yt,U),n(Zt,M),n(te,((B=t(st))==null?void 0:B.whitelist_count)||0),at(ht,1,`tab-btn ${t(g)==="blocklists"?"tab-active":""}`,"svelte-14cy5cw"),at(yt,1,`tab-btn ${t(g)==="countries"?"tab-active":""}`,"svelte-14cy5cw"),at(mt,1,`tab-btn ${t(g)==="log"?"tab-active":""}`,"svelte-14cy5cw"),at(Lt,1,`tab-btn ${t(g)==="whitelist"?"tab-active":""}`,"svelte-14cy5cw")},[()=>ft(t(pt).total_ips),()=>ft(t(ot).total_blocked_24h)]),r(s,d)};j(Gt,s=>{t(It)?s(Kt):s(Qt,!1)})}e(_t),r(Ut,_t),ne()}ie(["click","change"]);export{$e as component};
