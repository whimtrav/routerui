import{d as Ne,f as _,a as b,s as E}from"../chunks/DhZLAEWt.js";import{o as Ve}from"../chunks/D-tgmMSQ.js";import{p as Fe,s as y,a as te,f as t,d as a,g as e,t as O,b as Re,e as Se,c as o,$ as Te,r,n as pe,h as re}from"../chunks/N1otwjTT.js";import{i as U}from"../chunks/CWp393YG.js";import{e as $e,i as Me}from"../chunks/CxGl9W59.js";import{h as Le,s as De}from"../chunks/DtPs97YY.js";import{r as F,a as ue}from"../chunks/uT__Kkxm.js";import{b as J,a as Ie}from"../chunks/DLE3Upo7.js";import{b as fe}from"../chunks/7SKTmCmy.js";var Je=_('<div class="p-4 bg-red-500/20 border border-red-500/50 rounded text-red-400"> </div>'),qe=_('<div class="p-4 bg-green-500/20 border border-green-500/50 rounded text-green-400"> </div>'),Be=_('<div class="card svelte-9fk07v"><h3 class="text-lg font-semibold mb-4">Add New User</h3> <div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><label class="block text-sm text-gray-400 mb-1">Username</label> <input type="text" class="input w-full svelte-9fk07v" placeholder="Enter username"/></div> <div><label class="block text-sm text-gray-400 mb-1">Role</label> <select class="input w-full svelte-9fk07v"><option>Viewer (read-only)</option><option>Operator (can make changes)</option><option>Admin (full access)</option></select></div> <div><label class="block text-sm text-gray-400 mb-1">Password</label> <input class="input w-full svelte-9fk07v" placeholder="Enter password"/></div> <div><label class="block text-sm text-gray-400 mb-1">Confirm Password</label> <input class="input w-full svelte-9fk07v" placeholder="Confirm password"/></div></div> <div class="flex items-center gap-4 mt-4"><label class="flex items-center gap-2 text-sm text-gray-400"><input type="checkbox"/> Show password</label> <button class="btn-primary svelte-9fk07v">Create User</button></div></div>'),ze=_('<div class="text-gray-400">Loading...</div>'),Ge=_('<span class="text-xs text-blue-400 ml-2">(you)</span>'),He=_('<div class="flex-1 grid grid-cols-1 md:grid-cols-4 gap-4"><div><span class="text-lg font-medium"> </span> <!></div> <div><label class="block text-xs text-gray-400 mb-1">New Password (optional)</label> <input type="password" class="input w-full text-sm svelte-9fk07v" placeholder="Leave blank to keep"/></div> <div><label class="block text-xs text-gray-400 mb-1">Confirm Password</label> <input type="password" class="input w-full text-sm svelte-9fk07v" placeholder="Confirm new password"/></div> <div><label class="block text-xs text-gray-400 mb-1">Role</label> <select class="input w-full text-sm svelte-9fk07v"><option>Viewer</option><option>Operator</option><option>Admin</option></select></div></div> <div class="flex gap-2 ml-4"><button class="btn-primary text-sm svelte-9fk07v">Save</button> <button class="btn-secondary text-sm svelte-9fk07v">Cancel</button></div>',1),Ke=_('<span class="text-xs text-blue-400 ml-2">(you)</span>'),Qe=_('<button class="text-red-400 hover:text-red-300 text-sm">Delete</button>'),We=_('<div class="flex items-center gap-4"><div><span class="text-lg font-medium"> </span> <!></div> <span> </span></div> <div class="flex gap-2"><button class="text-blue-400 hover:text-blue-300 text-sm">Edit</button> <!></div>',1),Xe=_('<div class="p-4 bg-gray-700/50 rounded flex items-center justify-between"><!></div>'),Ye=_('<div class="card svelte-9fk07v"><h3 class="text-lg font-semibold mb-4"> </h3> <div class="space-y-3"></div></div> <div class="card svelte-9fk07v"><h3 class="text-lg font-semibold mb-4">Role Permissions</h3> <div class="grid grid-cols-1 md:grid-cols-3 gap-4"><div class="p-4 bg-gray-700/50 rounded"><div class="flex items-center gap-2 mb-2"><span class="text-xs px-2 py-1 rounded uppercase bg-blue-500/20 text-blue-400">Viewer</span></div> <ul class="text-sm text-gray-400 space-y-1"><li>View dashboard and status</li> <li>View network configuration</li> <li>View logs and statistics</li> <li>Cannot make changes</li></ul></div> <div class="p-4 bg-gray-700/50 rounded"><div class="flex items-center gap-2 mb-2"><span class="text-xs px-2 py-1 rounded uppercase bg-yellow-500/20 text-yellow-400">Operator</span></div> <ul class="text-sm text-gray-400 space-y-1"><li>All Viewer permissions</li> <li>Modify network settings</li> <li>Manage firewall rules</li> <li>Cannot manage users</li></ul></div> <div class="p-4 bg-gray-700/50 rounded"><div class="flex items-center gap-2 mb-2"><span class="text-xs px-2 py-1 rounded uppercase bg-red-500/20 text-red-400">Admin</span></div> <ul class="text-sm text-gray-400 space-y-1"><li>All Operator permissions</li> <li>Create and delete users</li> <li>Change user roles</li> <li>Full system access</li></ul></div></div></div>',1),Ze=_('<div class="space-y-6"><div class="flex items-center justify-between"><div><h2 class="text-2xl font-bold">Users</h2> <p class="text-sm text-gray-500">Manage RouterUI user accounts</p></div> <button class="btn-primary svelte-9fk07v"> </button></div> <!> <!> <!> <!></div>');function ns(me,be){Fe(be,!0);let oe=y(!0),X=y(te([])),q=y(null),n=y(""),P=y(""),R=y(!1),S=y(null),i=y(te({username:"",password:"",confirmPassword:"",role:"viewer"})),d=y(te({password:"",confirmPassword:"",role:""})),B=y(!1);async function z(){try{const s=await fetch("/api/users");s.ok&&t(X,await s.json(),!0)}catch(s){console.error(s)}finally{t(oe,!1)}}async function _e(){try{const s=await fetch("/api/auth/me");s.ok&&t(q,await s.json(),!0)}catch(s){console.error(s)}}Ve(()=>{z(),_e()});async function we(){if(t(n,""),t(P,""),!e(i).username||!e(i).password){t(n,"Username and password are required");return}if(e(i).password!==e(i).confirmPassword){t(n,"Passwords do not match");return}if(e(i).password.length<8){t(n,"Password must be at least 8 characters");return}try{const s=await fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e(i).username,password:e(i).password,role:e(i).role})});if(s.ok)t(P,"User created successfully"),t(i,{username:"",password:"",confirmPassword:"",role:"viewer"},!0),t(R,!1),await z();else{const l=await s.json().catch(()=>({}));t(n,l.message||"Failed to create user",!0)}}catch{t(n,"Network error")}}function xe(s){t(S,s,!0),t(d,{password:"",confirmPassword:"",role:s.role},!0)}function Y(){t(S,null),t(d,{password:"",confirmPassword:"",role:""},!0)}async function ge(){if(t(n,""),t(P,""),e(d).password&&e(d).password!==e(d).confirmPassword){t(n,"Passwords do not match");return}if(e(d).password&&e(d).password.length<8){t(n,"Password must be at least 8 characters");return}const s={};if(e(d).password&&(s.password=e(d).password),e(d).role!==e(S).role&&(s.role=e(d).role),Object.keys(s).length===0){Y();return}try{(await fetch(`/api/users/${e(S).id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok?(t(P,"User updated successfully"),Y(),await z()):t(n,"Failed to update user")}catch{t(n,"Network error")}}async function ye(s){if(confirm(`Are you sure you want to delete user "${s.username}"?`)){t(n,""),t(P,"");try{const l=await fetch(`/api/users/${s.id}`,{method:"DELETE"});if(l.ok)t(P,"User deleted successfully"),await z();else{const f=await l.json().catch(()=>({}));t(n,f.message||"Failed to delete user",!0)}}catch{t(n,"Network error")}}}function he(s){switch(s){case"admin":return"bg-red-500/20 text-red-400";case"operator":return"bg-yellow-500/20 text-yellow-400";case"viewer":return"bg-blue-500/20 text-blue-400";default:return"bg-gray-500/20 text-gray-400"}}var Z=Ze();Le("9fk07v",s=>{Se(()=>{Te.title="Users - RouterUI"})});var ee=o(Z),se=a(o(ee),2);se.__click=()=>t(R,!e(R));var ke=o(se,!0);r(se),r(ee);var le=a(ee,2);{var Pe=s=>{var l=Je(),f=o(l,!0);r(l),O(()=>E(f,e(n))),b(s,l)};U(le,s=>{e(n)&&s(Pe)})}var ie=a(le,2);{var Ue=s=>{var l=qe(),f=o(l,!0);r(l),O(()=>E(f,e(P))),b(s,l)};U(ie,s=>{e(P)&&s(Ue)})}var de=a(ie,2);{var Ce=s=>{var l=Be(),f=a(o(l),2),C=o(f),G=a(o(C),2);F(G),r(C);var N=a(C,2),T=a(o(N),2),v=o(T);v.value=v.__value="viewer";var A=a(v);A.value=A.__value="operator";var H=a(A);H.value=H.__value="admin",r(T),r(N);var $=a(N,2),M=a(o($),2);F(M),r($);var h=a($,2),m=a(o(h),2);F(m),r(h),r(f);var x=a(f,2),w=o(x),g=o(w);F(g),pe(),r(w);var L=a(w,2);L.__click=we,r(x),r(l),O(()=>{ue(M,"type",e(B)?"text":"password"),ue(m,"type",e(B)?"text":"password")}),J(G,()=>e(i).username,p=>e(i).username=p),fe(T,()=>e(i).role,p=>e(i).role=p),J(M,()=>e(i).password,p=>e(i).password=p),J(m,()=>e(i).confirmPassword,p=>e(i).confirmPassword=p),Ie(g,()=>e(B),p=>t(B,p)),b(s,l)};U(de,s=>{e(R)&&s(Ce)})}var Ae=a(de,2);{var je=s=>{var l=ze();b(s,l)},Ee=s=>{var l=Ye(),f=re(l),C=o(f),G=o(C);r(C);var N=a(C,2);$e(N,21,()=>e(X),Me,(T,v)=>{var A=Xe(),H=o(A);{var $=h=>{var m=He(),x=re(m),w=o(x),g=o(w),L=o(g,!0);r(g);var p=a(g,2);{var ae=k=>{var W=Ge();b(k,W)};U(p,k=>{var W;((W=e(q))==null?void 0:W.id)===e(v).id&&k(ae)})}r(w);var j=a(w,2),K=a(o(j),2);F(K),r(j);var V=a(j,2),D=a(o(V),2);F(D),r(V);var Q=a(V,2),I=a(o(Q),2),u=o(I);u.value=u.__value="viewer";var c=a(u);c.value=c.__value="operator";var ne=a(c);ne.value=ne.__value="admin",r(I),r(Q),r(x);var ve=a(x,2),ce=o(ve);ce.__click=ge;var Oe=a(ce,2);Oe.__click=Y,r(ve),O(()=>E(L,e(v).username)),J(K,()=>e(d).password,k=>e(d).password=k),J(D,()=>e(d).confirmPassword,k=>e(d).confirmPassword=k),fe(I,()=>e(d).role,k=>e(d).role=k),b(h,m)},M=h=>{var m=We(),x=re(m),w=o(x),g=o(w),L=o(g,!0);r(g);var p=a(g,2);{var ae=u=>{var c=Ke();b(u,c)};U(p,u=>{var c;((c=e(q))==null?void 0:c.id)===e(v).id&&u(ae)})}r(w);var j=a(w,2),K=o(j,!0);r(j),r(x);var V=a(x,2),D=o(V);D.__click=()=>xe(e(v));var Q=a(D,2);{var I=u=>{var c=Qe();c.__click=()=>ye(e(v)),b(u,c)};U(Q,u=>{var c;((c=e(q))==null?void 0:c.id)!==e(v).id&&u(I)})}r(V),O(u=>{E(L,e(v).username),De(j,1,`text-xs px-2 py-1 rounded uppercase ${u??""}`,"svelte-9fk07v"),E(K,e(v).role)},[()=>he(e(v).role)]),b(h,m)};U(H,h=>{var m;((m=e(S))==null?void 0:m.id)===e(v).id?h($):h(M,!1)})}r(A),b(T,A)}),r(N),r(f),pe(2),O(()=>E(G,`User Accounts (${e(X).length??""})`)),b(s,l)};U(Ae,s=>{e(oe)?s(je):s(Ee,!1)})}r(Z),O(()=>E(ke,e(R)?"Cancel":"+ Add User")),b(me,Z),Re()}Ne(["click"]);export{ns as component};
