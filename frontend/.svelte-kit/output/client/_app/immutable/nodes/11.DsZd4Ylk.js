import{d as Bt,f as d,a as i,s as _,c as Ut}from"../chunks/DhZLAEWt.js";import{o as qt}from"../chunks/D-tgmMSQ.js";import{p as Gt,s as y,a as Ht,h as E,c as n,g as t,b as Kt,f as u,e as Qt,d as l,$ as Vt,n as F,r as s,t as f}from"../chunks/N1otwjTT.js";import{i as b}from"../chunks/CWp393YG.js";import{e as Wt,i as Xt}from"../chunks/CxGl9W59.js";import{h as Yt,s as pt}from"../chunks/DtPs97YY.js";import{r as Zt}from"../chunks/uT__Kkxm.js";import{a as ta}from"../chunks/DLE3Upo7.js";var aa=d('<div class="text-gray-400">Loading...</div>'),ea=d('<span class="text-gray-500 text-sm ml-2"> </span>'),ra=d('<span class="text-xs px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded">auto-start</span>'),sa=d('<button class="btn-action btn-yellow svelte-4z030h"> </button> <button class="btn-action btn-red svelte-4z030h"> </button>',1),na=d('<button class="btn-action btn-green svelte-4z030h"> </button>'),oa=d('<button class="btn-action btn-gray svelte-4z030h" title="Disable auto-start">Disable</button>'),la=d('<button class="btn-action btn-blue svelte-4z030h" title="Enable auto-start">Enable</button>'),ia=d('<p class="text-sm text-gray-400 ml-6"> </p>'),va=d("<span> </span>"),da=d("<span> </span>"),ca=d("<span> </span>"),_a=d('<div class="p-4 bg-gray-700/50 rounded"><div class="flex items-center justify-between mb-2"><div class="flex items-center gap-3"><div></div> <div><span class="font-medium"> </span> <!></div> <span> </span> <!></div> <div class="flex items-center gap-2"><!> <!> <button class="btn-action btn-gray svelte-4z030h">Logs</button></div></div> <!> <div class="flex gap-4 text-xs text-gray-500 mt-2 ml-6"><!> <!> <!></div></div>'),pa=d('<div class="card"><div class="grid grid-cols-3 gap-4"><div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold"> </p> <p class="text-xs text-gray-400">Total Services</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-green-400"> </p> <p class="text-xs text-gray-400">Running</p></div> <div class="bg-gray-700/50 rounded p-3 text-center"><p class="text-2xl font-bold text-red-400"> </p> <p class="text-xs text-gray-400">Failed</p></div></div></div> <div class="card"><h3 class="text-lg font-semibold mb-4"> </h3> <div class="space-y-3"></div></div>',1),ua=d('<div class="text-gray-400">Loading logs...</div>'),fa=d('<pre class="text-xs font-mono text-gray-300 whitespace-pre-wrap"> </pre>'),ba=d('<p class="text-gray-500">No logs available.</p>'),ga=d('<div class="fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4"><div class="bg-gray-800 rounded-lg w-full max-w-4xl max-h-[80vh] flex flex-col"><div class="flex items-center justify-between p-4 border-b border-gray-700"><h3 class="text-lg font-semibold"> </h3> <button class="text-gray-400 hover:text-white text-2xl">&times;</button></div> <div class="flex-1 overflow-auto p-4"><!></div> <div class="p-4 border-t border-gray-700 flex justify-end"><button class="btn-primary svelte-4z030h">Close</button></div></div></div>'),xa=d('<div class="space-y-6"><div class="flex items-center justify-between"><div><h2 class="text-2xl font-bold">Services</h2> <p class="text-sm text-gray-500">Manage system services and daemons.</p></div> <label class="flex items-center gap-2 text-sm"><input type="checkbox" class="rounded"/> <span>Show all services</span></label></div> <!></div> <!>',1);function ja(ut,ft){Gt(ft,!0);let tt=y(!0),J=y(Ht([])),at=y(0),et=y(0),P=y(!1),R=y(null),$=y(""),N=y(!1),x=y(null);async function T(){try{const o=t(P)?"/api/services/all":"/api/services",v=await fetch(o);if(v.ok){const p=await v.json();u(J,p.services,!0),u(at,p.total_running,!0),u(et,p.total_failed,!0)}}catch(o){console.error(o)}finally{u(tt,!1)}}qt(()=>{T();const o=setInterval(T,1e4);return()=>clearInterval(o)});async function z(o,v){u(x,`${o}-${v}`);try{(await fetch("/api/services/action",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:o,action:v})})).ok&&(await new Promise(h=>setTimeout(h,1e3)),await T())}finally{u(x,null)}}async function bt(o){u(R,o,!0),u(N,!0),u($,"");try{const v=await fetch("/api/services/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:o.name,lines:100})});if(v.ok){const p=await v.json();u($,p.logs,!0)}}finally{u(N,!1)}}function B(){u(R,null),u($,"")}function gt(o){switch(o){case"active":return"text-green-400";case"inactive":return"text-gray-400";case"failed":return"text-red-400";default:return"text-yellow-400"}}function xt(o){switch(o){case"active":return"bg-green-500/20";case"inactive":return"bg-gray-500/20";case"failed":return"bg-red-500/20";default:return"bg-yellow-500/20"}}var rt=xa();Yt("4z030h",o=>{Qt(()=>{Vt.title="Services - RouterUI"})});var U=E(rt),q=n(U),st=l(n(q),2),G=n(st);Zt(G),G.__change=T,F(2),s(st),s(q);var mt=l(q,2);{var yt=o=>{var v=aa();i(o,v)},ht=o=>{var v=pa(),p=E(v),h=n(p),k=n(h),I=n(k),H=n(I,!0);s(I),F(2),s(k);var S=l(k,2),C=n(S),K=n(C,!0);s(C),F(2),s(S);var O=l(S,2),j=n(O),Q=n(j,!0);s(j),F(2),s(O),s(h),s(p);var g=l(p,2),w=n(g),V=n(w,!0);s(w);var A=l(w,2);Wt(A,21,()=>t(J),Xt,(W,a)=>{var m=_a(),L=n(m),X=n(L),nt=n(X),Y=l(nt,2),Z=n(Y),St=n(Z,!0);s(Z);var $t=l(Z,2);{var zt=r=>{var e=ea(),c=n(e);s(e),f(()=>_(c,`(${t(a).name??""})`)),i(r,e)};b($t,r=>{t(a).display_name!==t(a).name&&r(zt)})}s(Y);var D=l(Y,2),jt=n(D,!0);s(D);var Lt=l(D,2);{var Pt=r=>{var e=ra();i(r,e)};b(Lt,r=>{t(a).is_enabled&&r(Pt)})}s(X);var ot=l(X,2),lt=n(ot);{var Rt=r=>{var e=sa(),c=E(e);c.__click=()=>z(t(a).name,"restart");var Jt=n(c,!0);s(c);var M=l(c,2);M.__click=()=>z(t(a).name,"stop");var Nt=n(M,!0);s(M),f(()=>{c.disabled=t(x)===`${t(a).name}-restart`,_(Jt,t(x)===`${t(a).name}-restart`?"...":"Restart"),M.disabled=t(x)===`${t(a).name}-stop`,_(Nt,t(x)===`${t(a).name}-stop`?"...":"Stop")}),i(r,e)},Tt=r=>{var e=na();e.__click=()=>z(t(a).name,"start");var c=n(e,!0);s(e),f(()=>{e.disabled=t(x)===`${t(a).name}-start`,_(c,t(x)===`${t(a).name}-start`?"...":"Start")}),i(r,e)};b(lt,r=>{t(a).is_running?r(Rt):r(Tt,!1)})}var it=l(lt,2);{var It=r=>{var e=oa();e.__click=()=>z(t(a).name,"disable"),f(()=>e.disabled=t(x)===`${t(a).name}-disable`),i(r,e)},Ct=r=>{var e=la();e.__click=()=>z(t(a).name,"enable"),f(()=>e.disabled=t(x)===`${t(a).name}-enable`),i(r,e)};b(it,r=>{t(a).is_enabled?r(It):r(Ct,!1)})}var Ot=l(it,2);Ot.__click=()=>bt(t(a)),s(ot),s(L);var vt=l(L,2);{var At=r=>{var e=ia(),c=n(e,!0);s(e),f(()=>_(c,t(a).description)),i(r,e)};b(vt,r=>{t(a).description&&r(At)})}var dt=l(vt,2),ct=n(dt);{var Dt=r=>{var e=va(),c=n(e);s(e),f(()=>_(c,`PID: ${t(a).pid??""}`)),i(r,e)};b(ct,r=>{t(a).pid&&r(Dt)})}var _t=l(ct,2);{var Mt=r=>{var e=da(),c=n(e);s(e),f(()=>_(c,`Memory: ${t(a).memory??""}`)),i(r,e)};b(_t,r=>{t(a).memory&&r(Mt)})}var Et=l(_t,2);{var Ft=r=>{var e=ca(),c=n(e);s(e),f(()=>_(c,`Started: ${t(a).uptime??""}`)),i(r,e)};b(Et,r=>{t(a).uptime&&t(a).is_running&&r(Ft)})}s(dt),s(m),f((r,e)=>{pt(nt,1,`w-3 h-3 rounded-full ${t(a).is_running?"bg-green-500":t(a).status==="failed"?"bg-red-500":"bg-gray-500"}`),_(St,t(a).display_name),pt(D,1,`text-xs px-2 py-0.5 rounded ${r??""} ${e??""}`,"svelte-4z030h"),_(jt,t(a).status)},[()=>xt(t(a).status),()=>gt(t(a).status)]),i(W,m)}),s(A),s(g),f(()=>{_(H,t(J).length),_(K,t(at)),_(Q,t(et)),_(V,t(P)?"All Running Services":"Router Services")}),i(o,v)};b(mt,o=>{t(tt)?o(yt):o(ht,!1)})}s(U);var wt=l(U,2);{var kt=o=>{var v=ga();v.__click=B;var p=n(v);p.__click=g=>g.stopPropagation();var h=n(p),k=n(h),I=n(k);s(k);var H=l(k,2);H.__click=B,s(h);var S=l(h,2),C=n(S);{var K=g=>{var w=ua();i(g,w)},O=g=>{var w=Ut(),V=E(w);{var A=a=>{var m=fa(),L=n(m,!0);s(m),f(()=>_(L,t($))),i(a,m)},W=a=>{var m=ba();i(a,m)};b(V,a=>{t($)?a(A):a(W,!1)},!0)}i(g,w)};b(C,g=>{t(N)?g(K):g(O,!1)})}s(S);var j=l(S,2),Q=n(j);Q.__click=B,s(j),s(p),s(v),f(()=>_(I,`Logs: ${t(R).display_name??""}`)),i(o,v)};b(wt,o=>{t(R)&&o(kt)})}ta(G,()=>t(P),o=>u(P,o)),i(ut,rt),Kt()}Bt(["change","click"]);export{ja as component};
